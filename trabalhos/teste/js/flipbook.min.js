var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.Book=function(h,c){var b=this,e,a=c.main;this.main=c.main;this.hasTouch=a.hasTouch;this.perspective=a.perspective;this.transform=a.transform;this.transformOrigin=a.transformOrigin;this.transformStyle=a.transformStyle;this.transition=a.transition;this.transitionDuration=a.transitionDuration;this.transitionDelay=a.transitionDelay;this.transitionProperty=a.transitionProperty;this.backfaceVisibility=a.backfaceVisibility;this.wrapper=typeof h=="object"?h:document.getElementById(h);jQuery(this.wrapper).addClass("flipbook-book");this.options={onTurnPageComplete:null,flipType:"2d",shadow1opacity:0.7,shadow2opacity:0.7};for(e in c){this.options[e]=c[e]}this.pages=[];this.pageWidth=this.options.pageWidth;this.pageHeight=this.options.pageHeight;this.animating=false;this.rightIndex=0;this.onTurnPageComplete=this.options.onTurnPageComplete;var g=this.wrapper.style;g.width=String(2*this.pageWidth)+"px";g.height=String(this.pageHeight)+"px";this.flipType=this.options.flipType;this.shadow1opacity=this.options.shadow1opacity;this.shadow2opacity=this.options.shadow2opacity;var f,d;this.shadowL=document.createElement("div");jQuery(this.shadowL).addClass("flipbook-shadowLeft").css("width",String(this.pageWidth)+"px").css("height",String(this.pageHeight)+"px");this.wrapper.appendChild(this.shadowL);this.shadowLVisible=true;this.shadowR=document.createElement("div");jQuery(this.shadowR).addClass("flipbook-shadowRight").css("width",String(this.pageWidth)+"px").css("height",String(this.pageHeight)+"px");this.wrapper.appendChild(this.shadowR);this.shadowRVisible=true;this.shadowRight();for(e=0;e<b.options.pages.length;e++){this.addPage(e);jQuery(this.pages[e].wrapper).attr("title",e+1).bind(b.main.CLICK_EV,function(l){var p,i,n,o,m,k;p=b.main.scroll.x;i=b.xOnMouseDown;n=b.main.scroll.y;o=b.yOnMouseDown;m=b.zoomOnMouseUp;k=b.zoomOnMouseDown;function q(s,r){return(Math.abs(s-r)<10)}if(b.main.scroll.moved||b.main.scroll.animating||b.main.scroll.zoomed||(b.zoomOnMouseDown!=b.main.scroll.scale)){return}if(l.target.className=="flipbook-page-link"){return}if(q(p,i)&&q(n,o)&&m===k){var j=Number(jQuery(this).attr("title"))-1;if(j==b.rightIndex){b.nextPage()}else{b.prevPage()}}}).bind(b.main.START_EV,function(i){b.zoomOnMouseDown=b.main.scroll.scale;b.xOnMouseDown=b.main.scroll.x;b.yOnMouseDown=b.main.scroll.y}).bind(b.main.END_EV,function(i){b.zoomOnMouseUp=b.main.scroll.scale;b.xOnMouseUp=b.main.scroll.x;b.yOnMouseUp=b.main.scroll.y})}this.pages[0].loadPage();this.pages[1].loadPage();if(this.pages.length>2){this.pages[2].loadPage()}this.updateVisiblePages();jQuery(this.wrapper).on("DOMMouseScroll",function(i){i.preventDefault()});jQuery(this.wrapper).on("mousewheel",function(i){i.preventDefault()})};FLIPBOOK.Book.prototype.constructor=FLIPBOOK.Book;FLIPBOOK.Book.prototype={addPage:function(a){var b=new FLIPBOOK.Page(this.options.pages[a],this.pageWidth,this.pageHeight,this.pages.length,this);this.wrapper.appendChild(b.wrapper);this.pages.push(b)},goToPage:function(b){if(b<0||b>this.pages.length){return}if(this.animating){return}if(isNaN(b)){return}this.goingToPage=b;b=(b%2==1)?b+1:b;if(b==0){this.rightIndex==this.pages.length?this.shadowNone():this.shadowRight()}else{if(b==this.pages.length){this.rightIndex==0?this.shadowNone():this.shadowLeft()}}var c,e,d,a;if(b<this.rightIndex){c=this.pages[this.rightIndex-1];e=this.pages[b];if(b>0){d=this.pages[b-1];if(this.flipType=="2d"){d.expand()}d.show()}if(this.flipType=="2d"){e.contract()}this.animatePages(c,e)}else{if(b>this.rightIndex){c=this.pages[b-1];e=this.pages[this.rightIndex];if(b<this.pages.length){a=this.pages[b];if(this.flipType=="2d"){a.expand()}a.show()}if(this.flipType=="2d"){c.contract()}this.animatePages(e,c)}}this.rightIndex=b},animatePages:function(h,b){this.animating=true;var a=this,g=a.options.time1,e=a.options.time2,d=a.options.transition1,c=a.options.transition2;h.show();jQuery(h.wrapper).css(a.transform,"rotateY(0deg)");if(this.flipType=="3d"){b.show();jQuery(b.wrapper).css("visibility","hidden");jQuery(h.wrapper).css("visibility","visible");jQuery(h.wrapper).css("text-indent","0px");jQuery(h.wrapper).css(a.transform,"rotateY(0deg)");var f=(h.index<b.index)?"-90":"90";jQuery(h.overlay).animate({opacity:a.shadow1opacity},{duration:g,easing:d});jQuery(h.wrapper).animate({textIndent:f},{step:function(i,j){jQuery(this).css(a.transform,"rotateY("+Math.round(i)+"deg)")},duration:g,easing:d,complete:function(){h.hide();h.hideVisibility();jQuery(b.wrapper).css("visibility","visible");jQuery(b.overlay).css("opacity",a.shadow1opacity);jQuery(b.overlay).animate({opacity:0},{duration:e,easing:c});jQuery(b.wrapper).css(a.transform,"rotateY("+f+"deg)");jQuery(b.wrapper).css("text-indent",String(-f)+"px");jQuery(b.wrapper).animate({textIndent:0},{step:function(i,j){jQuery(this).css(a.transform,"rotateY("+Math.round(i)+"deg)")},complete:function(){jQuery(h.wrapper).css(a.transform,"rotateY(0deg)");jQuery(h.wrapper).css("visibility","visible");jQuery(b.wrapper).css(a.transform,"rotateY(0deg)");jQuery(b.wrapper).css("visibility","visible")},duration:e,easing:c})}})}else{jQuery(h.wrapper).animate({width:0},g,d,function(){b.show();jQuery(b.wrapper).animate({width:b.width},e,c)})}setTimeout(function(){console.log("timeout! both");if(a.onTurnPageComplete){a.onTurnPageComplete.call(a)}a.main.updateCurrentPage();a.animating=false;a.updateVisiblePages();h.overlay.style.opacity="0";jQuery(h.wrapper).css(a.transform,"rotateY(0deg)");jQuery(b.wrapper).css(a.transform,"rotateY(0deg)")},Number(g)+Number(e))},updateVisiblePages:function(){if(this.animating){return}for(var c=0;c<this.pages.length;c++){if((c<(this.rightIndex-1))||(c>(this.rightIndex))){if(this.flipType=="2d"){this.pages[c].contract()}this.pages[c].hide()}else{if(this.flipType=="2d"){this.pages[c].expand()}this.pages[c].show()}if(this.rightIndex==0){if(this.flipType=="2d"){this.pages[1].contract()}this.pages[1].hide()}}var b=this.rightIndex,a=this.pages;if(b>2){a[b-3].loadPage()}if(b>0){a[b-2].loadPage()}if(b>0){a[b-1].loadPage()}if(b<a.length){a[b].loadPage()}if(b<a.length){a[b+1].loadPage()}if(b<a.length-2){a[b+2].loadPage()}if(b>0&&b<this.pages.length){this.shadowBoth()}else{if(b==0){this.shadowRight()}else{this.shadowLeft()}}},nextPage:function(){if(this.rightIndex==this.pages.length||this.animating){return}this.goToPage(this.rightIndex+2)},prevPage:function(){if(this.rightIndex==0||this.animating){return}this.goToPage(this.rightIndex-2)},shadowRight:function(){if(this.shadowLVisible){this.shadowLVisible=false;this.shadowL.style.display="none"}if(!this.shadowRVisible){this.shadowRVisible=true;this.shadowR.style.display="block"}},shadowLeft:function(){if(this.shadowRVisible){this.shadowRVisible=false;this.shadowR.style.display="none"}if(!this.shadowLVisible){this.shadowLVisible=true;this.shadowL.style.display="block"}},shadowBoth:function(){if(!this.shadowRVisible){this.shadowRVisible=true;this.shadowR.style.display="block"}if(!this.shadowLVisible){this.shadowLVisible=true;this.shadowL.style.display="block"}},shadowNone:function(){if(this.shadowRVisible){this.shadowRVisible=false;this.shadowR.style.display="none"}if(this.shadowLVisible){this.shadowLVisible=false;this.shadowL.style.display="none"}}};var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.BookWebGL=function(c,a){this.wrapper=typeof c=="object"?c:document.getElementById(c);this.options=a;this.pageW=a.pageWidth;this.pageH=a.pageHeight;this.onTurnPageComplete=null;this.scroll=a.scroll;this.pagesArr=a.pagesArr;this.pages=[];this.animating=false;this.rightIndex=0;this.sc=1;var b=this.wrapper.style;b.width="100%";b.height="100%";b.position="absolute";b.overflow="hidden";this.init3d();this.createPages();this.rendering=false;this.render(true);this.onResize()};FLIPBOOK.BookWebGL.prototype=new THREE.Object3D();FLIPBOOK.BookWebGL.prototype.constructor=FLIPBOOK.BookWebGL;FLIPBOOK.BookWebGL.prototype.init3d=function(){var m=this,k=30,l=jQuery(m.wrapper).width(),f=jQuery(m.wrapper).height(),j=l/f,e=1,a=10000,b=this.options;m.clock=new THREE.Clock();m.scene=new THREE.Scene();m.camera=new THREE.PerspectiveCamera(k,j,e,a);m.scene.add(m.camera);m.zoom=b.zoom;m.pan=b.pan;m.tilt=b.tilt;this.updateCameraPosition();this.canvas=document.createElement("canvas");var n=this.canvas.style;n.width="100%";n.height="100%";n.position="absolute";this._bind("DOMMouseScroll",this.canvas);this._bind("mousewheel",this.canvas);this._bind("mouseout",this.canvas);this._bind(this.options.parent.START_EV,this.canvas);this._bind(this.options.parent.MOVE_EV,this.canvas);this._bind(this.options.parent.END_EV,this.canvas);this._bind(this.options.parent.CANCEL_EV,this.canvas);m.renderer=new THREE.WebGLRenderer({antialias:true,canvas:this.canvas});m.renderer.setSize(l,f);if(b.pageShadow){m.renderer.shadowMapEnabled=true;m.renderer.shadowMapWidth=1024;m.renderer.shadowMapHeight=1024}jQuery(window).resize(function(){m.onResize()});if(b.pointLight==true){var d=new THREE.PointLight(b.pointLightColor);d.position.set(b.pointLightX,b.pointLightY,b.pointLightZ);d.intensity=b.pointLightIntensity;m.scene.add(d)}if(b.directionalLight==true){var g=new THREE.DirectionalLight(b.directionalLightColor);g.position.set(b.directionalLightX,b.directionalLightY,b.directionalLightZ);g.intensity=b.directionalLightIntensity;m.scene.add(g)}if(b.ambientLight==true){var i=new THREE.AmbientLight(b.ambientLightColor);i.intensity=b.ambientLightIntensity;m.scene.add(i)}if(b.spotLight){var c=new THREE.SpotLight(b.spotLightColor);c.position.z=b.spotLightZ;c.intensity=b.spotLightIntensity;c.shadowMapWidth=1024;c.shadowMapHeight=1024;c.shadowCameraNear=b.spotLightShadowCameraNear;c.shadowCameraFar=b.spotLightShadowCameraFar;c.castShadow=b.spotLightCastShadow;c.shadowDarkness=b.spotLightShadowDarkness;m.scene.add(c)}m.scene.add(this);this.position.set(b.bookX,b.bookY,b.bookZ);this.centerContainer=new THREE.Object3D();this.add(this.centerContainer);this.centerContainer.position.x=-this.pageW*0.5;this.flippedleft=0;this.flippedright=0;this.cameraZMin=300;this.cameraZMax=5000};FLIPBOOK.BookWebGL.prototype.onResize=function(){var a=jQuery(this.wrapper).width(),b=jQuery(this.wrapper).height();if(b>a){this.sc=a/b}else{this.sc=1}this.renderer.setSize(a,b);this.camera.aspect=a/b;this.camera.updateProjectionMatrix();this.updateCameraPosition()};FLIPBOOK.BookWebGL.prototype.updateCameraPosition=function(){var d=Math.PI*this.tilt/180;var c=0;var b=this.options.cameraDistance*Math.sin(d)/(this.zoom);var a=this.options.cameraDistance*Math.cos(d)/(this.zoom);this.scale.set(this.sc,this.sc,this.sc);d=Math.PI*this.pan/180;c=Math.sin(d)*a;a=Math.cos(d)*a;this.camera.position.set(Math.round(c),Math.round(b),Math.round(a));this.camera.lookAt(this.scene.position)};FLIPBOOK.BookWebGL.prototype.createPages=function(){for(var b=0;b<this.pagesArr.length/2;b++){var d=THREE.ImageUtils.loadTexture(this.pagesArr[2*b].src);var a=THREE.ImageUtils.loadTexture(this.pagesArr[2*b+1].src);var c=(b==0||b==(this.pagesArr.length/2-1))?this.options.coverHardness:this.options.pageHardness;this.addPage(d,a,c);this.flippedright++}};FLIPBOOK.BookWebGL.prototype.getNumPages=function(){return(this.pages.length)};FLIPBOOK.BookWebGL.prototype.centerContainer=function(){return(this.centerContainer)};FLIPBOOK.BookWebGL.prototype.addPage=function(a,c,d){var b=this.pages.length;var e=new FLIPBOOK.PageWebGL(this,b,a,c,d,this.options);this.pages.push(e);this.centerContainer.add(e)};FLIPBOOK.BookWebGL.prototype.goToPage=function(b){this.goingToPage=b;b%2!=0?b++:b;var a=this;if(this.rightIndex>b){this.prevPage();if(this.rightIndex>b){setTimeout(function(){a.goToPage(b)},300)}}if(this.rightIndex<b){this.nextPage();if(this.rightIndex<b){setTimeout(function(){a.goToPage(b)},300)}}};FLIPBOOK.BookWebGL.prototype.nextPage=function(){if(this.flippedright==0){return}var a;for(a=0;a<this.pages.length;a++){if(this.pages[a].flippingRight){return}}var b=this.pages[this.pages.length-this.flippedright];if(!b.flipping){b.flipLeft()}this.flippedleft++;this.flippedright--;this.rightIndex+=2;this.options.parent.updateCurrentPage()};FLIPBOOK.BookWebGL.prototype.prevPage=function(){if(this.flippedleft==0){return}var a;for(a=0;a<this.pages.length;a++){if(this.pages[a].flippingLeft){return}}var b=this.pages[this.flippedleft-1];if(!b.flipping){b.flipRight()}this.flippedleft--;this.flippedright++;this.rightIndex-=2;this.options.parent.updateCurrentPage()};FLIPBOOK.BookWebGL.prototype.firstPage=function(){};FLIPBOOK.BookWebGL.prototype.lastPage=function(){};FLIPBOOK.BookWebGL.prototype.updateVisiblePages=function(){};FLIPBOOK.BookWebGL.prototype.pageClicked=function(b,a){};FLIPBOOK.BookWebGL.prototype.render=function(a){var c=this;c.rendering=a;a?c.wrapper.appendChild(c.renderer.domElement):c.wrapper.removeChild(c.renderer.domElement);var b=function(){if(c.rendering){requestAnimationFrame(b);TWEEN.update();c.renderer.render(c.scene,c.camera)}};b()};FLIPBOOK.BookWebGL.prototype.zoomTo=function(d){if(this.zooming){return}var a=this,c=2;var b=d>0?this.zoom*c:this.zoom/c;b=b>this.options.zoomMax?this.options.zoomMax:b;b=b<this.options.zoomMin?this.options.zoomMin:b;this.zooming=true;new TWEEN.Tween(this).to({zoom:b},200).easing(TWEEN.Easing.Sinusoidal.EaseInOut).onUpdate(this.updateCameraPosition).onComplete(function(){a.zooming=false}).start()};FLIPBOOK.BookWebGL.prototype.tiltTo=function(d){var b=this,c=0.3;var a=this.tilt+d*c;a=a>this.options.tiltMax?this.options.tiltMax:a;a=a<this.options.tiltMin?this.options.tiltMin:a;this.tilt=a;this.updateCameraPosition()};FLIPBOOK.BookWebGL.prototype.panTo=function(d){var a=this,c=0.2;var b=this.pan-d*c;b=b>this.options.panMax?this.options.panMax:b;b=b<this.options.panMin?this.options.panMin:b;this.pan=b;this.updateCameraPosition()};FLIPBOOK.BookWebGL.prototype._bind=function(c,b,a){(b||this.wrapper).addEventListener(c,this,!!a)};FLIPBOOK.BookWebGL.prototype.handleEvent=function(b){var a=this;switch(b.type){case a.options.parent.START_EV:if(!a.options.parent.hasTouch&&b.button!==0){return}a._start(b);break;case a.options.parent.MOVE_EV:a._move(b);break;case"mouseout":a._end(b);break;case a.options.parent.END_EV:case a.options.parent.CANCEL_EV:a._end(b);break;case"DOMMouseScroll":case"mousewheel":a._wheel(b);break}};FLIPBOOK.BookWebGL.prototype._wheel=function(c){c.preventDefault();var b,a;if("wheelDeltaX" in c){b=c.wheelDeltaX/12;a=c.wheelDeltaY/12}else{if("wheelDelta" in c){b=a=c.wheelDelta/12}else{if("detail" in c){b=a=-c.detail*3}else{return}}}this.zoomTo(a);if(this.zoom<=1){this.resetCameraPosition()}};FLIPBOOK.BookWebGL.prototype.resetCameraPosition=function(){this.position.x=this.options.bookX;this.position.y=this.options.bookY;this.position.z=this.options.bookZ};FLIPBOOK.BookWebGL.prototype._start=function(f){this.mouseDown=true;var a=this.options.parent.hasTouch?f.touches[0]:f;this.pointX=a.pageX;this.pointY=a.pageY;this.startPoint=a;var b=this._getVector(f);var g=new THREE.Projector();g.unprojectVector(b,this.camera);var c=new THREE.Raycaster(this.camera.position,b.sub(this.camera.position).normalize());var d=c.intersectObjects(this.pages);this.pageMouseDown=(d.length>0)};FLIPBOOK.BookWebGL.prototype._getVector=function(f){var c=jQuery(this.canvas).width(),d=jQuery(this.canvas).height(),b=f.clientX,i=f.clientY,a=jQuery(this.canvas).offset().x,g=jQuery(this.canvas).offset().y;return new THREE.Vector3((b/c)*2-1,-(i/d)*2+1,0.5)};FLIPBOOK.BookWebGL.prototype._move=function(h){h.preventDefault();var d=this._getVector(h);var i=new THREE.Projector();i.unprojectVector(d,this.camera);var f=new THREE.Raycaster(this.camera.position,d.sub(this.camera.position).normalize());var g=f.intersectObjects(this.pages);if(g.length>0){this.wrapper.style.cursor="pointer"}else{this.wrapper.style.cursor="move"}var b=this.options.parent.hasTouch?h.touches[0]:h,c=(b.pageX-this.pointX)*0.5,a=(b.pageY-this.pointY)*0.5;this.pointX=b.pageX;this.pointY=b.pageY;if(!this.mouseDown){return}if(this.zoom<=1){this.tiltTo(a);this.panTo(c)}if(this.zoom>1){this.position.x+=(4*c/this.zoom);this.position.y-=(4*a/this.zoom)}else{this.resetCameraPosition()}};FLIPBOOK.BookWebGL.prototype._end=function(h){this.mouseDown=false;var b=this.options.parent.hasTouch?h.touches[0]:h;this.pointX=b.pageX;this.pointY=b.pageY;this.endPoint=b;var c=this._getVector(h);var i=new THREE.Projector();i.unprojectVector(c,this.camera);var d=new THREE.Raycaster(this.camera.position,c.sub(this.camera.position).normalize());var f=d.intersectObjects(this.pages);if(f.length>0){if(this.pageMouseDown&&Math.abs(this.startPoint.pageX-this.endPoint.pageX)<5&&Math.abs(this.startPoint.pageY-this.endPoint.pageY)<5){var a=f[0];var g=a.object;if(g.flipping){return}if(g.isFlippedLeft){this.prevPage()}else{this.nextPage()}}}this.pageMouseDown=false};FLIPBOOK.BookWebGL.prototype.moveCamera=function(b,a){};Detector={canvas:!!window.CanvasRenderingContext2D,webgl:(function(){try{return !!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(a){return false}})(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var a=document.createElement("div");a.id="webgl-error-message";a.style.fontFamily="monospace";a.style.fontSize="13px";a.style.fontWeight="normal";a.style.textAlign="center";a.style.background="#fff";a.style.color="#000";a.style.padding="1.5em";a.style.width="400px";a.style.margin="5em auto 0";if(!this.webgl){a.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")}return a},addGetWebGLMessage:function(c){var b,d,a;c=c||{};b=c.parent!==undefined?c.parent:document.body;d=c.id!==undefined?c.id:"oldie";a=Detector.getWebGLErrorMessage();a.id=d;b.appendChild(a)}};(function(i,E){var u=Math,n=E.createElement("div").style,z=(function(){var H="t,webkitT,MozT,msT,OT".split(","),G,F=0,m=H.length;for(;F<m;F++){G=H[F]+"ransform";if(G in n){return H[F].substr(0,H[F].length-1)}}return false})(),D=z?"-"+z.toLowerCase()+"-":"",l=s("transform"),x=s("transitionProperty"),k=s("transitionDuration"),o=s("transformOrigin"),B=s("transitionTimingFunction"),e=s("transitionDelay"),A=(/android/gi).test(navigator.appVersion),h=(/iphone|ipad/gi).test(navigator.appVersion),r=(/hp-tablet/gi).test(navigator.appVersion),j=s("perspective") in n,y="ontouchstart" in i&&!r,d=z!==false,f=s("transition") in n,g="onorientationchange" in i?"orientationchange":"resize",b=y?"touchstart":"mousedown",t=y?"touchmove":"mousemove",c=y?"touchend":"mouseup",w=y?"touchcancel":"mouseup",a=(function(){if(z===false){return false}var m={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return m[z]})(),q=(function(){return i.requestAnimationFrame||i.webkitRequestAnimationFrame||i.mozRequestAnimationFrame||i.oRequestAnimationFrame||i.msRequestAnimationFrame||function(m){return setTimeout(m,1)}})(),p=(function(){return i.cancelRequestAnimationFrame||i.webkitCancelAnimationFrame||i.webkitCancelRequestAnimationFrame||i.mozCancelRequestAnimationFrame||i.oCancelRequestAnimationFrame||i.msCancelRequestAnimationFrame||clearTimeout})(),C=j?" translateZ(0)":"",v=function(G,m){var H=this,F;H.wrapper=typeof G=="object"?G:E.getElementById(G);H.wrapper.style.overflow="hidden";H.scroller=H.wrapper.children[0];H.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,topOffset:0,checkDOMChanges:false,handleClick:true,hScrollbar:true,vScrollbar:true,fixedScrollbar:A,hideScrollbar:h,fadeScrollbar:h&&j,scrollbarClass:"",zoom:false,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:false,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(I){I.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null,keepInCenterH:false,keepInCenterV:false};for(F in m){H.options[F]=m[F]}H.x=H.options.x;H.y=H.options.y;H.options.useTransform=d&&H.options.useTransform;H.options.hScrollbar=H.options.hScroll&&H.options.hScrollbar;H.options.vScrollbar=H.options.vScroll&&H.options.vScrollbar;H.options.zoom=H.options.useTransform&&H.options.zoom;H.options.useTransition=f&&H.options.useTransition;H.keepInCenterH=H.options.keepInCenterH;H.keepInCenterV=H.options.keepInCenterV;if(H.options.zoom&&A){C=""}H.scroller.style[x]=H.options.useTransform?D+"transform":"top left";H.scroller.style[k]="0";H.scroller.style[o]="0 0";if(H.options.useTransition){H.scroller.style[B]="cubic-bezier(0.33,0.66,0.66,1)"}if(H.options.useTransform){H.scroller.style[l]="translate("+H.x+"px,"+H.y+"px)"+C}else{H.scroller.style.cssText+=";position:absolute;top:"+H.y+"px;left:"+H.x+"px"}if(H.options.useTransition){H.options.fixedScrollbar=true}H.refresh();H._bind(g,i);H._bind(b);if(!y){if(H.options.wheelAction!="none"){H._bind("DOMMouseScroll");H._bind("mousewheel")}}if(H.options.checkDOMChanges){H.checkDOMTime=setInterval(function(){H._checkDOMChanges()},500)}};v.prototype={enabled:true,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(F){var m=this;switch(F.type){case b:if(!y&&F.button!==0){return}m._start(F);break;case t:m._move(F);break;case c:case w:m._end(F);break;case g:m._resize();break;case"DOMMouseScroll":case"mousewheel":m._wheel(F);break;case a:m._transitionEnd(F);break}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||(this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)){return}this.refresh()},_scrollbar:function(m){var G=this,F;if(!G[m+"Scrollbar"]){if(G[m+"ScrollbarWrapper"]){if(d){G[m+"ScrollbarIndicator"].style[l]=""}G[m+"ScrollbarWrapper"].parentNode.removeChild(G[m+"ScrollbarWrapper"]);G[m+"ScrollbarWrapper"]=null;G[m+"ScrollbarIndicator"]=null}return}if(!G[m+"ScrollbarWrapper"]){F=E.createElement("div");if(G.options.scrollbarClass){F.className=G.options.scrollbarClass+m.toUpperCase()}else{F.style.cssText="position:absolute;z-index:100;"+(m=="h"?"height:7px;bottom:1px;left:2px;right:"+(G.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(G.hScrollbar?"7":"2")+"px;top:2px;right:1px")}F.style.cssText+=";pointer-events:none;"+D+"transition-property:opacity;"+D+"transition-duration:"+(G.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(G.options.hideScrollbar?"0":"1");G.wrapper.appendChild(F);G[m+"ScrollbarWrapper"]=F;F=E.createElement("div");if(!G.options.scrollbarClass){F.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+D+"background-clip:padding-box;"+D+"box-sizing:border-box;"+(m=="h"?"height:100%":"width:100%")+";"+D+"border-radius:3px;border-radius:3px"}F.style.cssText+=";pointer-events:none;"+D+"transition-property:"+D+"transform;"+D+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+D+"transition-duration:0;"+D+"transform: translate(0,0)"+C;if(G.options.useTransition){F.style.cssText+=";"+D+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"}G[m+"ScrollbarWrapper"].appendChild(F);G[m+"ScrollbarIndicator"]=F}if(m=="h"){G.hScrollbarSize=G.hScrollbarWrapper.clientWidth;G.hScrollbarIndicatorSize=u.max(u.round(G.hScrollbarSize*G.hScrollbarSize/G.scrollerW),8);G.hScrollbarIndicator.style.width=G.hScrollbarIndicatorSize+"px";G.hScrollbarMaxScroll=G.hScrollbarSize-G.hScrollbarIndicatorSize;G.hScrollbarProp=G.hScrollbarMaxScroll/G.maxScrollX}else{G.vScrollbarSize=G.vScrollbarWrapper.clientHeight;G.vScrollbarIndicatorSize=u.max(u.round(G.vScrollbarSize*G.vScrollbarSize/G.scrollerH),8);G.vScrollbarIndicator.style.height=G.vScrollbarIndicatorSize+"px";G.vScrollbarMaxScroll=G.vScrollbarSize-G.vScrollbarIndicatorSize;G.vScrollbarProp=G.vScrollbarMaxScroll/G.maxScrollY}G._scrollbarPos(m,true)},_resize:function(){var m=this;setTimeout(function(){m.refresh()},A?200:0)},_pos:function(m,F){if(this.zoomed){return}if(this.scrollerW<this.wrapperW&&this.keepInCenterH){m=(this.wrapperW-this.scrollerW)/2;this.moved=false}if(this.scrollerH<this.wrapperH&&this.keepInCenterV){F=(this.wrapperH-this.scrollerH)/2;this.moved=false}m=u.round(m);F=u.round(F);if(this.options.useTransform){this.scroller.style[l]="translate("+m+"px,"+F+"px) scale("+this.scale+")"+C}else{this.scroller.style.left=m+"px";this.scroller.style.top=F+"px"}this.x=m;this.y=F;this._scrollbarPos("h");this._scrollbarPos("v")},_scrollbarPos:function(m,H){var G=this,I=m=="h"?G.x:G.y,F;if(!G[m+"Scrollbar"]){return}I=G[m+"ScrollbarProp"]*I;if(I<0){if(!G.options.fixedScrollbar){F=G[m+"ScrollbarIndicatorSize"]+u.round(I*3);if(F<8){F=8}G[m+"ScrollbarIndicator"].style[m=="h"?"width":"height"]=F+"px"}I=0}else{if(I>G[m+"ScrollbarMaxScroll"]){if(!G.options.fixedScrollbar){F=G[m+"ScrollbarIndicatorSize"]-u.round((I-G[m+"ScrollbarMaxScroll"])*3);if(F<8){F=8}G[m+"ScrollbarIndicator"].style[m=="h"?"width":"height"]=F+"px";I=G[m+"ScrollbarMaxScroll"]+(G[m+"ScrollbarIndicatorSize"]-F)}else{I=G[m+"ScrollbarMaxScroll"]}}}G[m+"ScrollbarWrapper"].style[e]="0";G[m+"ScrollbarWrapper"].style.opacity=H&&G.options.hideScrollbar?"0":"1";G[m+"ScrollbarIndicator"].style[l]="translate("+(m=="h"?I+"px,0)":"0,"+I+"px)")+C},_start:function(K){var J=this,F=y?K.touches[0]:K,G,m,L,I,H;if(!J.enabled){return}if(J.options.onBeforeScrollStart){J.options.onBeforeScrollStart.call(J,K)}if(J.options.useTransition||J.options.zoom){J._transitionTime(0)}J.moved=false;J.animating=false;J.zoomed=false;J.distX=0;J.distY=0;J.absDistX=0;J.absDistY=0;J.dirX=0;J.dirY=0;if(J.options.zoom&&y&&K.touches.length>1){I=u.abs(K.touches[0].pageX-K.touches[1].pageX);H=u.abs(K.touches[0].pageY-K.touches[1].pageY);J.touchesDistStart=u.sqrt(I*I+H*H);J.originX=u.abs(K.touches[0].pageX+K.touches[1].pageX-J.wrapperOffsetLeft*2)/2-J.x;J.originY=u.abs(K.touches[0].pageY+K.touches[1].pageY-J.wrapperOffsetTop*2)/2-J.y;if(J.options.onZoomStart){J.options.onZoomStart.call(J,K)}}if(J.options.momentum){if(J.options.useTransform){G=getComputedStyle(J.scroller,null)[l].replace(/[^0-9\-.,]/g,"").split(",");m=+(G[12]||G[4]);L=+(G[13]||G[5])}else{m=+getComputedStyle(J.scroller,null).left.replace(/[^0-9-]/g,"");L=+getComputedStyle(J.scroller,null).top.replace(/[^0-9-]/g,"")}if(m!=J.x||L!=J.y){if(J.options.useTransition){J._unbind(a)}else{p(J.aniTime)}J.steps=[];J._pos(m,L);if(J.options.onScrollEnd){J.options.onScrollEnd.call(J)}}}J.absStartX=J.x;J.absStartY=J.y;J.startX=J.x;J.startY=J.y;J.pointX=F.pageX;J.pointY=F.pageY;J.startTime=K.timeStamp||Date.now();if(J.options.onScrollStart){J.options.onScrollStart.call(J,K)}J._bind(t,i);J._bind(c,i);J._bind(w,i)},_move:function(M){var K=this,N=y?M.touches[0]:M,I=N.pageX-K.pointX,G=N.pageY-K.pointY,m=K.x+I,O=K.y+G,J,H,F,L=M.timeStamp||Date.now();if(K.options.onBeforeScrollMove){K.options.onBeforeScrollMove.call(K,M)}if(K.options.zoom&&y&&M.touches.length>1){J=u.abs(M.touches[0].pageX-M.touches[1].pageX);H=u.abs(M.touches[0].pageY-M.touches[1].pageY);K.touchesDist=u.sqrt(J*J+H*H);K.zoomed=true;F=1/K.touchesDistStart*K.touchesDist*this.scale;if(F<K.options.zoomMin){F=0.5*K.options.zoomMin*Math.pow(2,F/K.options.zoomMin)}else{if(F>K.options.zoomMax){F=2*K.options.zoomMax*Math.pow(0.5,K.options.zoomMax/F)}}K.lastScale=F/this.scale;m=this.originX-this.originX*K.lastScale+this.x,O=this.originY-this.originY*K.lastScale+this.y;this.scroller.style[l]="translate("+m+"px,"+O+"px) scale("+F+")"+C;if(K.options.onZoom){K.options.onZoom.call(K,M)}return}K.pointX=N.pageX;K.pointY=N.pageY;if(m>0||m<K.maxScrollX){m=K.options.bounce?K.x+(I/2):m>=0||K.maxScrollX>=0?0:K.maxScrollX}if(O>K.minScrollY||O<K.maxScrollY){O=K.options.bounce?K.y+(G/2):O>=K.minScrollY||K.maxScrollY>=0?K.minScrollY:K.maxScrollY}K.distX+=I;K.distY+=G;K.absDistX=u.abs(K.distX);K.absDistY=u.abs(K.distY);if(K.absDistX<6&&K.absDistY<6){return}if(K.options.lockDirection){if(K.absDistX>K.absDistY+5){O=K.y;G=0}else{if(K.absDistY>K.absDistX+5){m=K.x;I=0}}}K.moved=true;K._pos(m,O);K.dirX=I>0?-1:I<0?1:0;K.dirY=G>0?-1:G<0?1:0;if(L-K.startTime>300){K.startTime=L;K.startX=K.x;K.startY=K.y}if(K.options.onScrollMove){K.options.onScrollMove.call(K,M)}},_end:function(M){if(y&&M.touches.length!==0){return}var K=this,S=y?M.changedTouches[0]:M,N,R,G={dist:0,time:0},m={dist:0,time:0},J=(M.timeStamp||Date.now())-K.startTime,O=K.x,L=K.y,Q,P,F,I,H;K._unbind(t,i);K._unbind(c,i);K._unbind(w,i);if(K.options.onBeforeScrollEnd){K.options.onBeforeScrollEnd.call(K,M)}if(K.zoomed){H=K.scale*K.lastScale;H=Math.max(K.options.zoomMin,H);H=Math.min(K.options.zoomMax,H);K.lastScale=H/K.scale;K.scale=H;K.x=K.originX-K.originX*K.lastScale+K.x;K.y=K.originY-K.originY*K.lastScale+K.y;K.scroller.style[k]="200ms";K.scroller.style[l]="translate("+K.x+"px,"+K.y+"px) scale("+K.scale+")"+C;K.zoomed=false;K.refresh();if(K.options.onZoomEnd){K.options.onZoomEnd.call(K,M,H)}return}if(!K.moved){if(true){if(K.doubleTapTimer&&K.options.zoom){clearTimeout(K.doubleTapTimer);K.doubleTapTimer=null;if(K.options.onZoomStart){K.options.onZoomStart.call(K,M)}if(K.options.onZoomEnd){setTimeout(function(){K.options.onZoomEnd.call(K,M,H)},200)}}else{if(this.options.handleClick){K.doubleTapTimer=setTimeout(function(){K.doubleTapTimer=null;N=S.target;while(N.nodeType!=1){N=N.parentNode}if(N.tagName!="SELECT"&&N.tagName!="INPUT"&&N.tagName!="TEXTAREA"){R=E.createEvent("MouseEvents");R.initMouseEvent("click",true,true,M.view,1,S.screenX,S.screenY,S.clientX,S.clientY,M.ctrlKey,M.altKey,M.shiftKey,M.metaKey,0,null);R._fake=true;N.dispatchEvent(R)}if(K.options.onTouchEnd){K.options.onTouchEnd.call(K,M)}},K.options.zoom?250:0)}}}K._resetPos(400);return}if(J<300&&K.options.momentum){G=O?K._momentum(O-K.startX,J,-K.x,K.scrollerW-K.wrapperW+K.x,K.options.bounce?K.wrapperW:0):G;m=L?K._momentum(L-K.startY,J,-K.y,(K.maxScrollY<0?K.scrollerH-K.wrapperH+K.y-K.minScrollY:0),K.options.bounce?K.wrapperH:0):m;O=K.x+G.dist;L=K.y+m.dist;if((K.x>0&&O>0)||(K.x<K.maxScrollX&&O<K.maxScrollX)){G={dist:0,time:0}}if((K.y>K.minScrollY&&L>K.minScrollY)||(K.y<K.maxScrollY&&L<K.maxScrollY)){m={dist:0,time:0}}}if(G.dist||m.dist){F=u.max(u.max(G.time,m.time),10);if(K.options.snap){Q=O-K.absStartX;P=L-K.absStartY;if(u.abs(Q)<K.options.snapThreshold&&u.abs(P)<K.options.snapThreshold){K.scrollTo(K.absStartX,K.absStartY,200)}else{I=K._snap(O,L);O=I.x;L=I.y;F=u.max(I.time,F)}}K.scrollTo(u.round(O),u.round(L),F);if(K.options.onTouchEnd){K.options.onTouchEnd.call(K,M)}return}if(K.options.snap){Q=O-K.absStartX;P=L-K.absStartY;if(u.abs(Q)<K.options.snapThreshold&&u.abs(P)<K.options.snapThreshold){K.scrollTo(K.absStartX,K.absStartY,200)}else{I=K._snap(K.x,K.y);if(I.x!=K.x||I.y!=K.y){K.scrollTo(I.x,I.y,I.time)}}if(K.options.onTouchEnd){K.options.onTouchEnd.call(K,M)}return}K._resetPos(200);if(K.options.onTouchEnd){K.options.onTouchEnd.call(K,M)}},_resetPos:function(F){var m=this;if(m.keepInCenterH&&m.scrollerW<m.wrapperW){resetX=m.x>=0?(m.wrapperW-m.scrollerW)/2:m.x<m.maxScrollX?m.maxScrollX:m.x}else{resetX=m.x>=0?0:m.x<m.maxScrollX?m.maxScrollX:m.x}if(m.keepInCenterV&&m.scrollerH<m.wrapperH){resetY=m.y>=m.minScrollY||m.maxScrollY>0?m.minScrollY:m.y<m.maxScrollY?m.maxScrollY:m.y;resetY=m.y>0?(m.wrapperH-m.scrollerH)/2:resetY}else{resetY=m.y>=m.minScrollY||m.maxScrollY>0?m.minScrollY:m.y<m.maxScrollY?m.maxScrollY:m.y}if(resetX==m.x&&resetY==m.y){if(m.moved){m.moved=false;if(m.options.onScrollEnd){m.options.onScrollEnd.call(m)}}if(m.hScrollbar&&m.options.hideScrollbar){if(z=="webkit"){m.hScrollbarWrapper.style[e]="300ms"}m.hScrollbarWrapper.style.opacity="0"}if(m.vScrollbar&&m.options.hideScrollbar){if(z=="webkit"){m.vScrollbarWrapper.style[e]="300ms"}m.vScrollbarWrapper.style.opacity="0"}return}m.scrollTo(resetX,resetY,F||0)},_wheel:function(J){var H=this,I,G,F,m,K;if("wheelDeltaX" in J){I=J.wheelDeltaX/12;G=J.wheelDeltaY/12}else{if("wheelDelta" in J){I=G=J.wheelDelta/12}else{if("detail" in J){I=G=-J.detail*3}else{return}}}if(H.options.wheelAction=="zoom"){K=H.scale*Math.pow(2,1/3*(G?G/Math.abs(G):0));if(K<H.options.zoomMin){K=H.options.zoomMin}if(K>H.options.zoomMax){K=H.options.zoomMax}if(K!=H.scale){if(!H.wheelZoomCount&&H.options.onZoomStart){H.options.onZoomStart.call(H,J)}H.wheelZoomCount++;H.zoom(J.pageX,J.pageY,K,400);setTimeout(function(){H.wheelZoomCount--;if(!H.wheelZoomCount&&H.options.onZoomEnd){H.options.onZoomEnd.call(H,J,H.scale)}},400)}return}F=H.x+I;m=H.y+G;if(F>0){F=0}else{if(F<H.maxScrollX){F=H.maxScrollX}}if(m>H.minScrollY){m=H.minScrollY}else{if(m<H.maxScrollY){m=H.maxScrollY}}if(H.maxScrollY<0){H.scrollTo(F,m,0)}},_transitionEnd:function(F){var m=this;if(F.target!=m.scroller){return}m._unbind(a);m._startAni()},_startAni:function(){var K=this,F=K.x,m=K.y,I=Date.now(),J,H,G;if(K.animating){return}if(!K.steps.length){K._resetPos(400);return}J=K.steps.shift();if(J.x==F&&J.y==m){J.time=0}K.animating=true;K.moved=true;if(K.options.useTransition){K._transitionTime(J.time);K._pos(J.x,J.y);K.animating=false;if(J.time){K._bind(a)}else{K._resetPos(0)}return}G=function(){var L=Date.now(),N,M;if(L>=I+J.time){K._pos(J.x,J.y);K.animating=false;if(K.options.onAnimationEnd){K.options.onAnimationEnd.call(K)}K._startAni();return}L=(L-I)/J.time-1;H=u.sqrt(1-L*L);N=(J.x-F)*H+F;M=(J.y-m)*H+m;K._pos(N,M);if(K.animating){K.aniTime=q(G)}};G()},_transitionTime:function(m){m+="ms";this.scroller.style[k]=m;if(this.hScrollbar){this.hScrollbarIndicator.style[k]=m}if(this.vScrollbar){this.vScrollbarIndicator.style[k]=m}},_momentum:function(L,F,J,m,N){var K=0.0006,G=u.abs(L)/F,H=(G*G)/(2*K),M=0,I=0;if(L>0&&H>J){I=N/(6/(H/G*K));J=J+I;G=G*J/H;H=J}else{if(L<0&&H>m){I=N/(6/(H/G*K));m=m+I;G=G*m/H;H=m}}H=H*(L<0?-1:1);M=G/K;return{dist:H,time:u.round(M)}},_offset:function(m){var G=-m.offsetLeft,F=-m.offsetTop;while(m=m.offsetParent){G-=m.offsetLeft;F-=m.offsetTop}if(m!=this.wrapper){G*=this.scale;F*=this.scale}return{left:G,top:F}},_snap:function(M,L){var J=this,I,H,K,G,F,m;K=J.pagesX.length-1;H=J.pagesX.length;for(I=0;I<H;I++){if(M>=J.pagesX[I]){K=I;break}}if(K==J.currPageX&&K>0&&J.dirX<0){K--}M=J.pagesX[K];F=u.abs(M-J.pagesX[J.currPageX]);F=F?u.abs(J.x-M)/F*500:0;J.currPageX=K;K=J.pagesY.length-1;for(I=0;I<K;I++){if(L>=J.pagesY[I]){K=I;break}}if(K==J.currPageY&&K>0&&J.dirY<0){K--}L=J.pagesY[K];m=u.abs(L-J.pagesY[J.currPageY]);m=m?u.abs(J.y-L)/m*500:0;J.currPageY=K;G=u.round(u.max(F,m))||200;return{x:M,y:L,time:G}},_bind:function(G,F,m){if(this.scroller.addEventListener){(F||this.scroller).addEventListener(G,this,!!m)}else{(F||this.scroller).attachEvent(G,this,!!m)}},_unbind:function(G,F,m){if(this.scroller.removeEventListener){(F||this.scroller).removeEventListener(G,this,!!m)}else{(F||this.scroller).detachEvent(G,this,!!m)}},destroy:function(){var m=this;m.scroller.style[l]="";m.hScrollbar=false;m.vScrollbar=false;m._scrollbar("h");m._scrollbar("v");m._unbind(g,i);m._unbind(b);m._unbind(t,i);m._unbind(c,i);m._unbind(w,i);if(!m.options.hasTouch){m._unbind("DOMMouseScroll");m._unbind("mousewheel")}if(m.options.useTransition){m._unbind(a)}if(m.options.checkDOMChanges){clearInterval(m.checkDOMTime)}if(m.options.onDestroy){m.options.onDestroy.call(m)}},refresh:function(){var H=this,J,G,m,F,K=0,I=0;if(H.scale<H.options.zoomMin){H.scale=H.options.zoomMin}H.wrapperW=H.wrapper.clientWidth||1;H.wrapperH=H.wrapper.clientHeight||1;H.minScrollY=-H.options.topOffset||0;H.scrollerW=u.round(H.scroller.offsetWidth*H.scale);H.scrollerH=u.round((H.scroller.offsetHeight+H.minScrollY)*H.scale);H.maxScrollX=H.wrapperW-H.scrollerW;H.maxScrollY=H.wrapperH-H.scrollerH+H.minScrollY;H.dirX=0;H.dirY=0;if(H.options.onRefresh){H.options.onRefresh.call(H)}H.hScroll=H.options.hScroll&&H.maxScrollX<0;H.vScroll=H.options.vScroll&&(!H.options.bounceLock&&!H.hScroll||H.scrollerH>H.wrapperH);H.hScrollbar=H.hScroll&&H.options.hScrollbar;H.vScrollbar=H.vScroll&&H.options.vScrollbar&&H.scrollerH>H.wrapperH;J=H._offset(H.wrapper);H.wrapperOffsetLeft=-J.left;H.wrapperOffsetTop=-J.top;if(typeof H.options.snap=="string"){H.pagesX=[];H.pagesY=[];F=H.scroller.querySelectorAll(H.options.snap);m=F.length;for(G=0;G<m;G++){K=H._offset(F[G]);K.left+=H.wrapperOffsetLeft;K.top+=H.wrapperOffsetTop;H.pagesX[G]=K.left<H.maxScrollX?H.maxScrollX:K.left*H.scale;H.pagesY[G]=K.top<H.maxScrollY?H.maxScrollY:K.top*H.scale}}else{if(H.options.snap){H.pagesX=[];while(K>=H.maxScrollX){H.pagesX[I]=K;K=K-H.wrapperW;I++}if(H.maxScrollX%H.wrapperW){H.pagesX[H.pagesX.length]=H.maxScrollX-H.pagesX[H.pagesX.length-1]+H.pagesX[H.pagesX.length-1]}K=0;I=0;H.pagesY=[];while(K>=H.maxScrollY){H.pagesY[I]=K;K=K-H.wrapperH;I++}if(H.maxScrollY%H.wrapperH){H.pagesY[H.pagesY.length]=H.maxScrollY-H.pagesY[H.pagesY.length-1]+H.pagesY[H.pagesY.length-1]}}}H._scrollbar("h");H._scrollbar("v");if(!H.zoomed){H.scroller.style[k]="0";H._resetPos(400)}},scrollTo:function(m,L,K,J){var I=this,H=m,G,F;I.stop();if(!H.length){H=[{x:m,y:L,time:K,relative:J}]}F=H.length;for(G=0;G<F;G++){if(H[G].relative){H[G].x=I.x-H[G].x;H[G].y=I.y-H[G].y}I.steps.push({x:H[G].x,y:H[G].y,time:H[G].time||0})}I._startAni()},scrollToElement:function(m,G){var F=this,H;m=m.nodeType?m:F.scroller.querySelector(m);if(!m){return}H=F._offset(m);H.left+=F.wrapperOffsetLeft;H.top+=F.wrapperOffsetTop;H.left=H.left>0?0:H.left<F.maxScrollX?F.maxScrollX:H.left;H.top=H.top>F.minScrollY?F.minScrollY:H.top<F.maxScrollY?F.maxScrollY:H.top;G=G===undefined?u.max(u.abs(H.left)*2,u.abs(H.top)*2):G;F.scrollTo(H.left,H.top,G)},scrollToPage:function(G,F,I){var H=this,m,J;I=I===undefined?400:I;if(H.options.onScrollStart){H.options.onScrollStart.call(H)}if(H.options.snap){G=G=="next"?H.currPageX+1:G=="prev"?H.currPageX-1:G;F=F=="next"?H.currPageY+1:F=="prev"?H.currPageY-1:F;G=G<0?0:G>H.pagesX.length-1?H.pagesX.length-1:G;F=F<0?0:F>H.pagesY.length-1?H.pagesY.length-1:F;H.currPageX=G;H.currPageY=F;m=H.pagesX[G];J=H.pagesY[F]}else{m=-H.wrapperW*G;J=-H.wrapperH*F;if(m<H.maxScrollX){m=H.maxScrollX}if(J<H.maxScrollY){J=H.maxScrollY}}H.scrollTo(m,J,I)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(t,i);this._unbind(c,i);this._unbind(w,i)},enable:function(){this.enabled=true},stop:function(){if(this.options.useTransition){this._unbind(a)}else{p(this.aniTime)}this.steps=[];this.moved=false;this.animating=false},zoom:function(m,J,I,H){var F=this,G=I/F.scale;if(!F.options.useTransform){return}F.zoomed=true;H=H===undefined?200:H;m=m-F.wrapperOffsetLeft-F.x;J=J-F.wrapperOffsetTop-F.y;F.x=m-m*G+F.x;F.y=J-J*G+F.y;F.scale=I;F.refresh();F.x=F.x>0?0:F.x<F.maxScrollX?F.maxScrollX:F.x;F.y=F.y>F.minScrollY?F.minScrollY:F.y<F.maxScrollY?F.maxScrollY:F.y;if(F.keepInCenterH){if(F.scrollerW<F.wrapperW){F.x=(F.wrapperW-F.scrollerW)/2}}if(F.keepInCenterV){if(F.scrollerH<F.wrapperH){F.y=(F.wrapperH-F.scrollerH)/2}}F.scroller.style[k]=H+"ms";F.scroller.style[l]="translate("+F.x+"px,"+F.y+"px) scale("+I+")"+C;F.zoomed=false},isReady:function(){return !this.moved&&!this.zoomed&&!this.animating},setX:function(m){this.x=m}};function s(m){if(z===""){return m}m=m.charAt(0).toUpperCase()+m.substr(1);return z+m}n=null;if(typeof exports!=="undefined"){exports.iScroll=v}else{i.iScroll=v}})(window,document);var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.Lightbox=function(c,d,b){var a=this;this.context=c;this.options=b;var e=(c.elem.nodeName.toLowerCase()==="img")?c.$elem:c.$elem.find("img");e.css("cursor","pointer").bind(c.START_EV,function(){a.openLightbox()});a.overlay=jQuery(document.createElement("div")).attr("class","flipbook-overlay").css("visibility","hidden").css("z-index","999999").bind(c.START_EV,function(f){if(jQuery(f.target).hasClass("flipbook-overlay")){a.closeLightbox()}}).appendTo("body");a.wrapper=jQuery(document.createElement("div")).css("width",a.options.lightboxWidth).css("height","auto").appendTo(a.overlay);if(a.options.lightboxTransparent==true){a.wrapper.attr("class","flipbook-wrapper-transparent").css("margin","0px auto").css("padding","0px").css("height","100%").css("width","100%")}else{a.wrapper.attr("class","flipbook-wrapper").css("margin",String(a.options.lightboxMargin)+"px auto").css("padding",String(a.options.lightboxPadding)+"px");d.css("margin",String(a.options.lightboxPadding)+"px")}d.appendTo(a.wrapper);jQuery(document.createElement("span")).attr("aria-hidden","true").appendTo(a.wrapper).addClass("icon-cross").addClass("icon-general").addClass("skin-color").css("right","0").css("top","0").css("position","absolute").css("cursor","pointer").bind(a.context.START_EV,function(f){a.closeLightbox()});a.resize();jQuery(window).resize(function(){a.resize()});a.resize()};FLIPBOOK.Lightbox.prototype={openLightbox:function(){var a=this;this.overlay.css("visibility","visible");this.overlay.css("display","none");this.wrapper.css("display","none");this.overlay.fadeIn("fast",function(){a.wrapper.css("display","block");a.context.lightboxStart()});jQuery("body").css("overflow","hidden");a.context.lightboxStart()},closeLightbox:function(){var a=this;this.overlay.fadeOut("fast");jQuery("body").css("overflow","auto");a.context.lightboxEnd()},resize:function(){var b=this;var d=jQuery(window),c=d.width(),a=d.height();if(b.options.lightboxTransparent==true){b.wrapper.css("width","100%")}else{b.wrapper.css("width",b.options.lightboxWidth);if((b.wrapper.width()+2*b.options.lightboxMargin+2*b.options.lightboxPadding)<b.options.lightboxMinWidth){b.wrapper.css("width",String(c-2*b.options.lightboxMargin-2*b.options.lightboxPadding)+"px")}}}};(function init(c,b,a,e){c.fn.flipBook=function(f){return this.each(function(){var g=new d();g.init(f,this)})};c.fn.flipBook.options={css:"",pdf:"",pages:[],assets:{preloader:"images/preloader.jpg",left:"images/left.png",overlay:"images/overlay.jpg"},startPage:1,pageWidth:1000,pageHeight:1414,thumbnailWidth:100,thumbnailHeight:141,currentPage:true,btnNext:true,btnPrev:true,btnZoomIn:true,btnZoomOut:true,btnToc:true,btnThumbs:true,btnShare:true,btnExpand:true,flipType:"3d",zoom:0.8,zoomMin:0.7,zoomMax:6,time1:500,transition1:"easeInQuad",time2:600,transition2:"easeOutQuad",social:[{name:"facebook",icon:"icon-facebook",url:"http://codecanyon.net"},{name:"twitter",icon:"icon-twitter",url:"http://codecanyon.net"},{name:"googleplus",icon:"icon-googleplus",url:"http://codecanyon.net"},{name:"linkedin",icon:"icon-linkedin",url:"http://codecanyon.net"},{name:"youtube",icon:"icon-youtube",url:"http://codecanyon.net"}],lightBox:false,lightboxTransparent:true,lightboxPadding:0,lightboxMargin:20,lightboxWidth:"75%",lightboxHeight:600,lightboxMinWidth:400,lightboxMinHeight:100,lightboxMaxWidth:9999,lightboxMaxHeight:9999,lightboxAutoSize:true,lightboxAutoHeight:false,lightboxAutoWidth:false,webgl:false,cameraDistance:2500,pan:0,panMax:5,panMin:-5,tilt:0,tiltMax:0,tiltMin:-60,bookX:0,bookY:0,bookZ:0,pageMaterial:"phong",pageShadow:false,pageHardness:1,coverHardness:4,pageSegmentsW:10,pageSegmentsH:3,pageShininess:25,pageFlipDuration:2,pointLight:false,pointLightX:0,pointLightY:0,pointLightZ:2000,pointLightColor:16777215,pointLightIntensity:0.1,directionalLight:false,directionalLightX:0,directionalLightY:0,directionalLightZ:1000,directionalLightColor:16777215,directionalLightIntensity:0.3,ambientLight:true,ambientLightColor:13421772,ambientLightIntensity:0.2,spotLight:true,spotLightX:0,spotLightY:0,spotLightZ:5000,spotLightColor:16777215,spotLightIntensity:0.2,spotLightShadowCameraNear:0.1,spotLightShadowCameraFar:10000,spotLightCastShadow:true,spotLightShadowDarkness:0.5};var d=function(){};d.prototype={init:function(h,C){var s=this;s.elem=C;s.$elem=c(C);s.options={};var q=a.createElement("div").style,D=(function(){var J="t,webkitT,MozT,msT,OT".split(","),I,H=0,G=J.length;for(;H<G;H++){I=J[H]+"ransform";if(I in q){return J[H].substr(0,J[H].length-1)}}return false})(),v=function(G){if(D===""){return G}G=G.charAt(0).toUpperCase()+G.substr(1);return D+G},F=(/android/gi).test(navigator.appVersion),m=(/iphone|ipad/gi).test(navigator.appVersion),u=(/hp-tablet/gi).test(navigator.appVersion),n=v("perspective") in q,B="ontouchstart" in b&&!u,l="onorientationchange" in b?"orientationchange":"resize",f=B?"touchend":"click",g=B?"touchstart":"mousedown",w=B?"touchmove":"mousemove",k=B?"touchend":"mouseup",y=B?"touchcancel":"mouseup",p=v("transform"),t=v("perspective"),A=v("transition"),x=v("transitionProperty"),o=v("transitionDuration"),r=v("transformOrigin"),z=v("transformStyle"),E=v("transitionTimingFunction"),j=v("transitionDelay"),i=v("backfaceVisibility");s.has3d=n;s.hasWebGl=Detector.webgl;s.hasTouch=B;s.RESIZE_EV=l;s.CLICK_EV=f;s.START_EV=g;s.MOVE_EV=w;s.END_EV=k;s.CANCEL_EV=y;s.transform=p;s.transitionProperty=x;s.transitionDuration=o;s.transformOrigin=r;s.transitionTimingFunction=E;s.transitionDelay=j;s.perspective=t;s.transformStyle=z;s.transition=A;s.backfaceVisibility=i;s.options=c.extend({},c.fn.flipBook.options,h);s.options.main=s;s.p=false;s.options.css==""?s.start():s.loadCSS(s.options.css)},start:function(){this.started=true;this.createBook();this.Book.updateVisiblePages();this.createMenu();if(this.options.currentPage){this.createCurrentPage();this.updateCurrentPage()}this.createToc();this.createThumbs();if(this.options.btnShare){this.createShareButtons()}this.resize()},loadCSS:function(g){c("#flipBookCSS").remove();var f=this;c('<link rel="stylesheet" type="text/css" href="'+g+'" id="flipBookCSS" />').appendTo("head");c.ajax({url:g,success:function(h){f.start()}})},reloadCSS:function(g){c("#flipBookCSS").remove();c('<link rel="stylesheet" type="text/css" href="'+g+'" id="flipBookCSS" />').appendTo("head");var f=this;c.ajax({url:g,success:function(h){f.resize()}})},createBook:function(){var f=this;if(f.options.pages.length%2!=0){alert("Number of pages must be even (2,4,6...)")}f.wrapper=c(a.createElement("div")).addClass("main-wrapper");f.bookLayer=c(a.createElement("div")).addClass("flipbook-bookLayer").appendTo(f.wrapper);f.bookLayer[0].style[f.transformOrigin]="100% 100%";f.book=c(a.createElement("div")).addClass("book").appendTo(f.bookLayer);if(f.options.lightBox){f.lightbox=new FLIPBOOK.Lightbox(this,f.wrapper,f.options);if(f.options.lightboxTransparent==true){f.wrapper.css("background","none");f.bookLayer.css("background","none");f.book.css("background","none")}}else{f.wrapper.appendTo(f.$elem)}f.options.onTurnPageComplete=f.onTurnPageComplete;if(!f.has3d){f.options.flipType="2d"}if(f.options.webgl&&f.hasWebGl){var g=f.options;g.pagesArr=f.options.pages;g.scroll=f.scroll;g.parent=f;f.Book=new FLIPBOOK.BookWebGL(f.book[0],g);f.webglMode=true}else{f.Book=new FLIPBOOK.Book(f.book[0],f.options);f.scroll=new iScroll(f.bookLayer[0],{wheelAction:"zoom",zoom:true,zoomMin:f.options.zoomMin,zoomMax:f.options.zoomMax,keepInCenterH:true,keepInCenterV:true,bounce:false});f.webglMode=false}f.Book.goToPage(Number(f.options.startPage)-1);c(b).resize(function(){f.resize()})},createMenu:function(){var k=this;this.menuWrapper=c(a.createElement("div")).addClass("flipbook-menuWrapper").appendTo(this.wrapper);this.menu=c(a.createElement("div")).addClass("flipbook-menu").addClass("skin-color-bg").appendTo(this.menuWrapper);if(this.options.lightboxTransparent){}if(k.options.btnPrev){var j=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.Book.prevPage()}).addClass("icon-arrow-left").addClass("flipbook-menu-btn").addClass("icon-general").addClass("skin-color")}if(k.options.btnNext){var h=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.Book.nextPage()}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-arrow-right").addClass("skin-color")}if(k.options.btnZoomIn){var f=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.zoomIn()}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-zoom-in").addClass("skin-color")}if(k.options.btnZoomOut){var l=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.zoomOut()}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-zoom-out").addClass("skin-color")}if(k.options.btnToc){var g=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.toggleToc()}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-list").addClass("skin-color")}if(k.options.btnThumbs){var i=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.toggleThumbs()}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-layout").addClass("skin-color")}if(k.options.btnShare){this.btnShare=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){k.toggleShare()}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-share").addClass("skin-color")}if(THREEx.FullScreen.available()&&k.options.btnExpand){var m=c(a.createElement("span")).attr("aria-hidden","true").appendTo(this.menu).bind(this.CLICK_EV,function(){if(THREEx.FullScreen.available()){if(THREEx.FullScreen.activated()){THREEx.FullScreen.cancel();c(this).removeClass("icon-resize-shrink").addClass("icon-resize-enlarge")}else{THREEx.FullScreen.request(k.wrapper[0]);c(this).removeClass("icon-resize-enlarge").addClass("icon-resize-shrink")}}}).addClass("flipbook-menu-btn").addClass("icon-general").addClass("icon-resize-enlarge").addClass("skin-color")}},createShareButtons:function(){var g=this;this.shareButtons=c(a.createElement("span")).appendTo(this.bookLayer).addClass("flipbook-shareButtons").addClass("skin-color-bg").addClass("invisible").addClass("transition");var h;for(h=0;h<g.options.social.length;h++){f(g.options.social[h])}function f(j){var i=c(a.createElement("span")).attr("aria-hidden","true").appendTo(g.shareButtons).addClass("flipbook-shareBtn").addClass(j.icon).addClass("icon-general").addClass("skin-color").bind(g.CLICK_EV,function(k){b.open(j.url,"_self")})}},zoomOut:function(){if(!this.webglMode){var f=this.scroll.scale/1.5<this.scroll.options.zoomMin?this.scroll.options.zoomMin:this.scroll.scale/1.5;this.scroll.zoom(this.bookLayer.width()/2,this.bookLayer.height()/2,f,400)}else{this.Book.zoomTo(-2)}},zoomIn:function(){if(!this.webglMode){var f=this.scroll.scale*1.5>this.scroll.options.zoomMax?this.scroll.options.zoomMax:this.scroll.scale*1.5;this.scroll.zoom(this.bookLayer.width()/2,this.bookLayer.height()/2,f,400)}else{this.Book.zoomTo(2)}},toggleShare:function(){this.shareButtons.toggleClass("invisible")},createCurrentPage:function(){var f=this;this.currentPage=c(a.createElement("input")).addClass("flipbook-currentPage").attr("type","text").addClass("skin-color").appendTo(this.menuWrapper).keyup(function(h){if(h.keyCode==13){var g=parseInt(c(this).val())-1;f.updateCurrentPage();f.Book.goToPage(g)}}).focus(function(g){c(this).val("")}).focusout(function(h){var g=parseInt(c(this).val())-1;f.updateCurrentPage();f.Book.goToPage(g)})},createToc:function(){var g=this;this.tocHolder=c(a.createElement("div")).addClass("flipbook-tocHolder").addClass("invisible").appendTo(this.wrapper);this.toc=c(a.createElement("div")).addClass(".flipbook-toc").appendTo(this.tocHolder);g.tocScroll=new iScroll(g.tocHolder[0],{bounce:false});var j=c(a.createElement("span")).addClass("flipbook-tocTitle").addClass("skin-color-bg").addClass("skin-color").appendTo(this.toc);var k=c(a.createElement("span")).attr("aria-hidden","true").appendTo(j).css("float","right").css("position","absolute").css("top","0px").css("right","0px").css("cursor","pointer").css("font-size",".8em").addClass("icon-cross").addClass("icon-general").addClass("skin- color").bind(g.START_EV,function(i){g.toggleToc()});for(var h=0;h<this.options.pages.length;h++){if(this.options.pages[h].title==""){continue}if(typeof this.options.pages[h].title==="undefined"){continue}var f=c(a.createElement("a")).attr("class","flipbook-tocItem").addClass("skin-color-bg").addClass("skin-color").attr("title",String(h+1)).appendTo(this.toc).bind(g.CLICK_EV,function(l){if(!g.tocScroll.moved){var i=Number(c(this).attr("title"))-1;if(g.Book.goingToPage!=i){g.Book.goToPage(i)}}});c(a.createElement("span")).appendTo(f).text(this.options.pages[h].title);c(a.createElement("span")).appendTo(f).attr("class","right").text(h+1)}g.tocScroll.refresh()},toggleToc:function(){this.tocHolder.toggleClass("invisible");this.tocScroll.refresh()},updateCurrentPage:function(){if(typeof this.currentPage==="undefined"){return}var h,g=this.Book.rightIndex,f=this.webglMode?this.Book.pages.length*2:this.Book.pages.length;if(g==0){h="1 / "+String(f)}else{if(g==f){h=String(f)+" / "+String(f)}else{h=String(g)+","+String(g+1)+" / "+String(f)}}if(this.p&&this.options.pages.length!=24&&this.options.pages.length!=8){this.Book.rightIndex=0}this.currentPage.attr("value",h);this.currentPage.attr("size",this.currentPage.val().length)},turnPageComplete:function(){this.animating=false;this.updateCurrentPage()},resize:function(){var h=this.bookLayer.width(),l=this.bookLayer.height(),m=this.book.width(),k=this.book.height(),j=this.menuWrapper.width();var i=this;if(h==0||l==0||m==0||k==0){setTimeout(function(){i.resize()},1000);return}if(h/l>=m/k){this.fitToHeight(true)}else{this.fitToWidth(true)}if(this.options.btnShare){var g=this.btnShare.offset().left;var f=this.bookLayer.offset().left;this.shareButtons.css("left",String(g-f)+"px")}},fitToHeight:function(g){var f=this.bookLayer.height();var h=this.book.height();if(g){this.ratio=f/h}this.fit(this.ratio,g);this.thumbsVertical()},fitToWidth:function(g){var f=this.bookLayer.width();var h=this.book.width();if(g){this.ratio=f/h}this.fit(this.ratio,g);this.thumbsVertical()},fit:function(g,f){if(!this.webglMode){g=f?this.ratio:this.scroll.scale;if(f){this.scroll.options.zoomMin=g*this.options.zoomMin;this.scroll.options.zoomMax=g*this.options.zoomMax}this.scroll.zoom(this.bookLayer.width()/2,this.bookLayer.height()/2,g*this.options.zoom,0)}},createThumbs:function(){var h=this,l,k;h.thumbsCreated=true;h.thumbHolder=c(a.createElement("div")).addClass("flipbook-thumbHolder").addClass("invisible").appendTo(h.bookLayer).css("position","absolute").css("display","none");h.thumbsContainer=c(a.createElement("div")).appendTo(h.thumbHolder).addClass("flipbook-thumbContainer").css("margin","0px").css("padding","0px").css("position","relative");h.thumbScroll=new iScroll(h.thumbHolder[0],{bounce:false});h.thumbs=[];for(var j=0;j<h.options.pages.length;j++){var m=h.options.pages[j].thumb;var f=0;var g=new FLIPBOOK.Thumb(c,h.Book,m,h.options.thumbnailWidth,h.options.thumbnailHeight,j);g.image.style[h.transform]="translateZ(0)";h.thumbs.push(g);c(g.image).attr("title",j+1).appendTo(h.thumbsContainer).bind(h.CLICK_EV,function(n){if(!h.thumbScroll.moved){var i=Number(c(this).attr("title"))-1;if(h.Book.goingToPage!=i){h.Book.goToPage(i)}}});g.loadImage()}},toggleThumbs:function(){if(!this.thumbsCreated){this.createThumbs()}this.thumbHolder.css("display","block");this.thumbHolder.toggleClass("invisible");var f=this;this.thumbsVertical()},thumbsVertical:function(){if(!this.thumbsCreated){return}var f=this.options.thumbnailWidth,k=this.options.thumbnailHeight*this.thumbs.length;this.thumbHolder.css("width",String(f)+"px").css("height","100%").css("bottom","auto").css("left","auto").css("top","0px").css("right","0px");this.thumbsContainer.css("height",String(k)+"px").css("width",String(f)+"px");for(var j=0;j<this.thumbs.length;j++){var g=this.thumbs[j].image;g.style.top=String(j*this.options.thumbnailHeight)+"px";g.style.left="0px"}this.thumbScroll.hScroll=false;this.thumbScroll.vScroll=true;this.thumbScroll.refresh()},thumbsHorizontal:function(){if(!this.thumbsCreated){return}var f=this.options.thumbnailWidth*this.thumbs.length,k=this.options.thumbnailHeight;this.thumbHolder.css("width","100%").css("height",String(k)+"px").css("left","0px").css("right","auto").css("top","auto").css("bottom","0px");this.thumbsContainer.css("height",String(k)+"px").css("width",String(f)+"px");for(var j=0;j<this.thumbs.length;j++){var g=this.thumbs[j].image;g.style.top="0px";g.style.left=String(j*this.options.thumbnailWidth)+"px"}this.thumbScroll.hScroll=true;this.thumbScroll.vScroll=false;this.thumbScroll.refresh()},toggleExpand:function(){if(THREEx.FullScreen.available()){if(THREEx.FullScreen.activated()){THREEx.FullScreen.cancel()}else{THREEx.FullScreen.request()}}},lightboxStart:function(){this.reloadCSS(this.options.css)},lightboxEnd:function(){if(THREEx.FullScreen.available()){if(THREEx.FullScreen.activated()){THREEx.FullScreen.cancel()}}}};c.extend(c.easing,{def:"easeOutQuad",swing:function(g,h,f,j,i){return c.easing[c.easing.def](g,h,f,j,i)},easeInQuad:function(g,h,f,j,i){return j*(h/=i)*h+f},easeOutQuad:function(g,h,f,j,i){return -j*(h/=i)*(h-2)+f},easeInOutQuad:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h+f}return -j/2*((--h)*(h-2)-1)+f},easeInCubic:function(g,h,f,j,i){return j*(h/=i)*h*h+f},easeOutCubic:function(g,h,f,j,i){return j*((h=h/i-1)*h*h+1)+f},easeInOutCubic:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h*h+f}return j/2*((h-=2)*h*h+2)+f},easeInQuart:function(g,h,f,j,i){return j*(h/=i)*h*h*h+f},easeOutQuart:function(g,h,f,j,i){return -j*((h=h/i-1)*h*h*h-1)+f},easeInOutQuart:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h*h*h+f}return -j/2*((h-=2)*h*h*h-2)+f},easeInQuint:function(g,h,f,j,i){return j*(h/=i)*h*h*h*h+f},easeOutQuint:function(g,h,f,j,i){return j*((h=h/i-1)*h*h*h*h+1)+f},easeInOutQuint:function(g,h,f,j,i){if((h/=i/2)<1){return j/2*h*h*h*h*h+f}return j/2*((h-=2)*h*h*h*h+2)+f},easeInSine:function(g,h,f,j,i){return -j*Math.cos(h/i*(Math.PI/2))+j+f},easeOutSine:function(g,h,f,j,i){return j*Math.sin(h/i*(Math.PI/2))+f},easeInOutSine:function(g,h,f,j,i){return -j/2*(Math.cos(Math.PI*h/i)-1)+f},easeInExpo:function(g,h,f,j,i){return(h==0)?f:j*Math.pow(2,10*(h/i-1))+f},easeOutExpo:function(g,h,f,j,i){return(h==i)?f+j:j*(-Math.pow(2,-10*h/i)+1)+f},easeInOutExpo:function(g,h,f,j,i){if(h==0){return f}if(h==i){return f+j}if((h/=i/2)<1){return j/2*Math.pow(2,10*(h-1))+f}return j/2*(-Math.pow(2,-10*--h)+2)+f},easeInCirc:function(g,h,f,j,i){return -j*(Math.sqrt(1-(h/=i)*h)-1)+f},easeOutCirc:function(g,h,f,j,i){return j*Math.sqrt(1-(h=h/i-1)*h)+f},easeInOutCirc:function(g,h,f,j,i){if((h/=i/2)<1){return -j/2*(Math.sqrt(1-h*h)-1)+f}return j/2*(Math.sqrt(1-(h-=2)*h)+1)+f},easeInElastic:function(g,i,f,m,l){var j=1.70158;var k=0;var h=m;if(i==0){return f}if((i/=l)==1){return f+m}if(!k){k=l*0.3}if(h<Math.abs(m)){h=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/h)}return -(h*Math.pow(2,10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k))+f},easeOutElastic:function(g,i,f,m,l){var j=1.70158;var k=0;var h=m;if(i==0){return f}if((i/=l)==1){return f+m}if(!k){k=l*0.3}if(h<Math.abs(m)){h=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/h)}return h*Math.pow(2,-10*i)*Math.sin((i*l-j)*(2*Math.PI)/k)+m+f},easeInOutElastic:function(g,i,f,m,l){var j=1.70158;var k=0;var h=m;if(i==0){return f}if((i/=l/2)==2){return f+m}if(!k){k=l*(0.3*1.5)}if(h<Math.abs(m)){h=m;var j=k/4}else{var j=k/(2*Math.PI)*Math.asin(m/h)}if(i<1){return -0.5*(h*Math.pow(2,10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k))+f}return h*Math.pow(2,-10*(i-=1))*Math.sin((i*l-j)*(2*Math.PI)/k)*0.5+m+f},easeInBack:function(g,h,f,k,j,i){if(i==e){i=1.70158}return k*(h/=j)*h*((i+1)*h-i)+f},easeOutBack:function(g,h,f,k,j,i){if(i==e){i=1.70158}return k*((h=h/j-1)*h*((i+1)*h+i)+1)+f},easeInOutBack:function(g,h,f,k,j,i){if(i==e){i=1.70158}if((h/=j/2)<1){return k/2*(h*h*(((i*=(1.525))+1)*h-i))+f}return k/2*((h-=2)*h*(((i*=(1.525))+1)*h+i)+2)+f},easeInBounce:function(g,h,f,j,i){return j-c.easing.easeOutBounce(g,i-h,0,j,i)+f},easeOutBounce:function(g,h,f,j,i){if((h/=i)<(1/2.75)){return j*(7.5625*h*h)+f}else{if(h<(2/2.75)){return j*(7.5625*(h-=(1.5/2.75))*h+0.75)+f}else{if(h<(2.5/2.75)){return j*(7.5625*(h-=(2.25/2.75))*h+0.9375)+f}else{return j*(7.5625*(h-=(2.625/2.75))*h+0.984375)+f}}}},easeInOutBounce:function(g,h,f,j,i){if(h<i/2){return c.easing.easeInBounce(g,h*2,0,j,i)*0.5+f}return c.easing.easeOutBounce(g,h*2-i,0,j,i)*0.5+j*0.5+f}})})(jQuery,window,document);var MOD3=MOD3||{};(function(b){b.Constants={PI:Math.PI,invPI:1/Math.PI,halfPI:0.5*Math.PI,doublePI:2*Math.PI,toRad:1/180*Math.PI,toDeg:1/180*Math.PI};b.ModConstant={LEFT:-1,RIGHT:1,NONE:0,X:1,Y:2,Z:4}})(MOD3);(function(b){var d=b.Constants;b.XMath={};b.XMath.normalize=function(g,f,a){return f-g==0?1:b.XMath.trim(0,1,(a-g)/f)};b.XMath.toRange=function(f,h,g){return h-f==0?0:f+(h-f)*g};b.XMath.inRange=function(g,j,i,h){typeof h=="undefined"&&(h=!1);return h?i>=g&&i<=j:i>g&&i<j};b.XMath.sign=function(e,f){typeof f=="undefined"&&(f=0);return 0==e?f:e>0?1:-1};b.XMath.trim=function(f,h,g){return Math.min(h,Math.max(f,g))};b.XMath.wrap=function(f,h,g){return g<f?g+(h-f):g>=h?g-(h-f):g};b.XMath.degToRad=function(c){return c*d.toRad};b.XMath.radToDeg=function(c){return c*d.toDeg};b.XMath.presicion=function(f,h){var g=Math.pow(10,h);return Math.round(f*g)/g};b.XMath.uceil=function(c){return c<0?Math.floor(c):Math.ceil(c)}})(MOD3);(function(b){b.Range=function(d,c){this.start=0;this.end=1;if(typeof d!="undefined"){this.start=d}if(typeof c!="undefined"){this.end=c}};b.Range.prototype.getSize=function(){return this.end-this.start};b.Range.prototype.move=function(c){this.start+=c;this.end+=c};b.Range.prototype.isIn=function(c){return c>=this.start&&c<=this.end};b.Range.prototype.normalize=function(a){return b.XMath.normalize(this.start,this.end,a)};b.Range.prototype.toRange=function(a){return b.XMath.toRange(this.start,this.end,a)};b.Range.prototype.trim=function(a){return b.XMath.trim(this.start,this.end,a)};b.Range.prototype.interpolate=function(d,c){return this.toRange(c.normalize(d))};b.Range.prototype.toString=function(){return"["+this.start+" - "+this.end+"]"}})(MOD3);(function(b){b.Phase=function(c){this.value=0;if(typeof c!="undefined"){this.value=c}};b.Phase.prototype.getPhasedValue=function(){return Math.sin(this.value)};b.Phase.prototype.getAbsPhasedValue=function(){return Math.abs(this.getPhasedValue())};b.Phase.prototype.getNormValue=function(){return(this.getPhasedValue()+1)*0.5}})(MOD3);(function(b){b.Point=function(d,c){this.y=this.x=0;if(typeof d!="undefined"){this.x=d}if(typeof c!="undefined"){this.y=c}};b.Point.prototype.clone=function(){return new b.Point(this.x,this.y)}})(MOD3);(function(b){b.Matrix=function(f,c,h,g){this.m11=1;this.m21=this.m12=0;this.m22=1;if(typeof f!="undefined"){this.m11=f}if(typeof c!="undefined"){this.m12=c}if(typeof h!="undefined"){this.m21=h}if(typeof g!="undefined"){this.m22=g}};b.Matrix.prototype.rotate=function(d){var c=Math.cos(d),d=Math.sin(d);this.m11=c;this.m12=-d;this.m21=d;this.m22=c;return this};b.Matrix.prototype.scale=function(d,c){this.m21=this.m12=0;if(typeof d!="undefined"){this.m22=this.m11=d}if(typeof c!="undefined"){this.m22=c}return this};b.Matrix.prototype.multiply=function(j){var c=this.m11,p=this.m12,o=this.m21,n=this.m22,m=j.m11,l=j.m12,k=j.m21,j=j.m22;this.m11=c*m+p*k;this.m12=c*l+p*j;this.m21=o*m+n*k;this.m22=o*l+n*j;return this};b.Matrix.prototype.transformPoint=function(a){return new b.Point(this.m11*a.x+this.m12*a.y,this.m21*a.x+this.m22*a.y)}})(MOD3);(function(b){b.Vector3=function(e,c,f){this.z=this.y=this.x=null;this.x=e;this.y=c;this.z=f};b.Vector3.ZERO=function(){return new b.Vector3(0,0,0)};b.Vector3.dot=function(d,c){return d.x*c.x+d.y*c.y+d.z*c.z};b.Vector3.prototype.clone=function(){return new b.Vector3(this.x,this.y,this.z)};b.Vector3.prototype.equals=function(c){return this.x==c.x&&this.y==c.y&&this.z==c.z};b.Vector3.prototype.zero=function(){this.x=this.y=this.z=0};b.Vector3.prototype.negate=function(){return new b.Vector3(-this.x,-this.y,-this.z)};b.Vector3.prototype.add=function(a){return new b.Vector3(this.x+a.x,this.y+a.y,this.z+a.z)};b.Vector3.prototype.subtract=function(a){return new b.Vector3(this.x-a.x,this.y-a.y,this.z-a.z)};b.Vector3.prototype.multiplyScalar=function(a){return new b.Vector3(this.x*a,this.y*a,this.z*a)};b.Vector3.prototype.multiply=function(a){return new b.Vector3(this.x*a.x,this.y*a.y,this.z*a.z)};b.Vector3.prototype.divide=function(a){a=1/a;return new b.Vector3(this.x*a,this.y*a,this.z*a)};b.Vector3.prototype.normalize=function(){var e=this.x,c=this.y,f=this.z,e=e*e+c*c+f*f;e>0&&(e=1/Math.sqrt(e),this.x*=e,this.y*=e,this.z*=e)};b.Vector3.prototype.getMagnitude=function(){var e=this.x,c=this.y,f=this.z;return Math.sqrt(e*e+c*c+f*f)};b.Vector3.prototype.setMagnitude=function(c){this.normalize();this.x*=c;this.y*=c;this.z*=c};b.Vector3.prototype.toString=function(){return"["+this.x+" , "+this.y+" , "+this.z+"]"};b.Vector3.prototype.sum=function(d,c){return d.add(c)};b.Vector3.prototype.dot=function(d,c){return d.x*c.x+d.y*c.y+d.z*c.z};b.Vector3.prototype.cross=function(p,a){var o=p.x,n=p.y,m=p.z,l=a.x,k=a.y,j=a.z;return new b.Vector3(n*j-m*k,m*l-o*j,o*k-n*l)};b.Vector3.prototype.distance=function(g,c){var j=g.x-c.x,i=g.y-c.y,h=g.z-c.z;return Math.sqrt(j*j+i*i+h*h)}})(MOD3);(function(b){b.Matrix4=function(F,E,D,C,B,A,z,y,t,u,s,w,r,v,x,c){this.n11=1;this.n21=this.n14=this.n13=this.n12=0;this.n22=1;this.n32=this.n31=this.n24=this.n23=0;this.n33=1;this.n43=this.n42=this.n41=this.n34=0;this.n44=1;if(typeof F!="undefined"){this.n11=F}if(typeof E!="undefined"){this.n12=E}if(typeof D!="undefined"){this.n13=D}if(typeof C!="undefined"){this.n14=C}if(typeof B!="undefined"){this.n21=B}if(typeof A!="undefined"){this.n22=A}if(typeof z!="undefined"){this.n23=z}if(typeof y!="undefined"){this.n24=y}if(typeof t!="undefined"){this.n31=t}if(typeof u!="undefined"){this.n32=u}if(typeof s!="undefined"){this.n33=s}if(typeof w!="undefined"){this.n34=w}if(typeof r!="undefined"){this.n41=r}if(typeof v!="undefined"){this.n42=v}if(typeof x!="undefined"){this.n43=x}if(typeof c!="undefined"){this.n44=c}};b.Matrix4.prototype.translationMatrix=function(e,c,f){this.n14=e;this.n24=c;this.n34=f;return this};b.Matrix4.prototype.scaleMatrix=function(e,c,f){this.n11=e;this.n22=c;this.n33=f;return this};b.Matrix4.prototype.rotationMatrix=function(v,u,t,s){var r=Math.cos(s),q=Math.sin(s),s=1-r,p=v*u*s,l=u*t*s,j=v*t*s,k=q*t,c=q*u;q*=v;this.n11=r+v*v*s;this.n12=-k+p;this.n13=c+j;this.n14=0;this.n21=k+p;this.n22=r+u*u*s;this.n23=-q+l;this.n24=0;this.n31=-c+j;this.n32=q+l;this.n33=r+t*t*s;this.n34=0;return this};b.Matrix4.prototype.calculateMultiply=function(Z,Y){var X=Z.n11,W=Y.n11,V=Z.n21,U=Y.n21,T=Z.n31,S=Y.n31,N=Z.n12,O=Y.n12,M=Z.n22,Q=Y.n22,L=Z.n32,P=Y.n32,R=Z.n13,J=Y.n13,I=Z.n23,G=Y.n23,H=Z.n33,F=Y.n33,E=Z.n14,D=Y.n14,c=Z.n24,C=Y.n24,K=Z.n34,B=Y.n34;this.n11=X*W+N*U+R*S;this.n12=X*O+N*Q+R*P;this.n13=X*J+N*G+R*F;this.n14=X*D+N*C+R*B+E;this.n21=V*W+M*U+I*S;this.n22=V*O+M*Q+I*P;this.n23=V*J+M*G+I*F;this.n24=V*D+M*C+I*B+c;this.n31=T*W+L*U+H*S;this.n32=T*O+L*Q+H*P;this.n33=T*J+L*G+H*F;this.n34=T*D+L*C+H*B+K};b.Matrix4.prototype.multiply=function(d,c){this.calculateMultiply(d,c);return this};b.Matrix4.prototype.multiplyVector=function(g,c){var j=c.x,i=c.y,h=c.z;c.x=j*g.n11+i*g.n12+h*g.n13+g.n14;c.y=j*g.n21+i*g.n22+h*g.n23+g.n24;c.z=j*g.n31+i*g.n32+h*g.n33+g.n34}})(MOD3);(function(b){b.VertexProxy=function(c){this.originalZ=this.originalY=this.originalX=this.ratioZ=this.ratioY=this.ratioX=null;if(typeof c!="undefined"){this.vertex=c}};b.VertexProxy.prototype.setVertex=function(){};b.VertexProxy.prototype.setRatios=function(e,c,f){this.ratioX=e;this.ratioY=c;this.ratioZ=f};b.VertexProxy.prototype.setOriginalPosition=function(e,c,f){this.originalX=e;this.originalY=c;this.originalZ=f};b.VertexProxy.prototype.getX=function(){};b.VertexProxy.prototype.getY=function(){};b.VertexProxy.prototype.getZ=function(){};b.VertexProxy.prototype.setX=function(){};b.VertexProxy.prototype.setY=function(){};b.VertexProxy.prototype.setZ=function(){};b.VertexProxy.prototype.getValue=function(a){switch(a){case b.ModConstant.X:return this.getX();case b.ModConstant.Y:return this.getY();case b.ModConstant.Z:return this.getZ()}return 0};b.VertexProxy.prototype.setValue=function(d,a){switch(d){case b.ModConstant.X:this.setX(a);break;case b.ModConstant.Y:this.setY(a);break;case b.ModConstant.Z:this.setZ(a)}};b.VertexProxy.prototype.getRatio=function(a){switch(a){case b.ModConstant.X:return this.ratioX;case b.ModConstant.Y:return this.ratioY;case b.ModConstant.Z:return this.ratioZ}return -1};b.VertexProxy.prototype.getOriginalValue=function(a){switch(a){case b.ModConstant.X:return this.originalX;case b.ModConstant.Y:return this.originalY;case b.ModConstant.Z:return this.originalZ}return 0};b.VertexProxy.prototype.reset=function(){this.setX(this.originalX);this.setY(this.originalY);this.setZ(this.originalZ)};b.VertexProxy.prototype.collapse=function(){this.originalX=this.getX();this.originalY=this.getY();this.originalZ=this.getZ()};b.VertexProxy.prototype.getVector=function(){return new b.Vector3(this.getX(),this.getY(),this.getZ())};b.VertexProxy.prototype.setVector=function(c){this.setX(c.x);this.setY(c.y);this.setZ(c.z)};b.VertexProxy.prototype.getRatioVector=function(){return new b.Vector3(this.ratioX,this.ratioY,this.ratioZ)}})(MOD3);(function(b){b.FaceProxy=function(){this.vertices=[]};b.FaceProxy.prototype.addVertex=function(c){this.vertices.push(c)};b.FaceProxy.prototype.getVertices=function(){return this.vertices}})(MOD3);(function(b){b.MeshProxy=function(){this.depth=this.height=this.width=this.minAxis=this.midAxis=this.maxAxis=this.minZ=this.minY=this.minX=this.maxZ=this.maxY=this.maxX=null;this.vertices=[];this.faces=[];this.mesh=null};b.MeshProxy.prototype.getVertices=function(){return this.vertices};b.MeshProxy.prototype.getFaces=function(){return this.faces};b.MeshProxy.prototype.analyzeGeometry=function(){for(var E=this.getVertices(),F=E.length,D=F,C,B,A,z,y,t,u,s,w,r,v=!0,x=Math.min,a=Math.max;--D>=0;){C=E[D],B=C.getX(),A=C.getY(),z=C.getZ(),v?(y=t=B,u=s=A,w=r=z,v=!1):(y=x(y,B),u=x(u,A),w=x(w,z),t=a(t,B),s=a(s,A),r=a(r,z)),C.setOriginalPosition(B,A,z)}B=t-y;A=s-u;depth=r-w;this.width=B;this.height=A;this.depth=depth;this.minX=y;this.maxX=t;this.minY=u;this.maxY=s;this.minZ=w;this.maxZ=r;D=a(B,a(A,depth));x=x(B,x(A,depth));if(D==B&&x==A){this.minAxis=b.ModConstant.Y,this.midAxis=b.ModConstant.Z,this.maxAxis=b.ModConstant.X}else{if(D==B&&x==depth){this.minAxis=b.ModConstant.Z,this.midAxis=b.ModConstant.Y,this.maxAxis=b.ModConstant.X}else{if(D==A&&x==B){this.minAxis=b.ModConstant.X,this.midAxis=b.ModConstant.Z,this.maxAxis=b.ModConstant.Y}else{if(D==A&&x==depth){this.minAxis=b.ModConstant.Z,this.midAxis=b.ModConstant.X,this.maxAxis=b.ModConstant.Y}else{if(D==depth&&x==B){this.minAxis=b.ModConstant.X,this.midAxis=b.ModConstant.Y,this.maxAxis=b.ModConstant.Z}else{if(D==depth&&x==A){this.minAxis=b.ModConstant.Y,this.midAxis=b.ModConstant.X,this.maxAxis=b.ModConstant.Z}}}}}}for(D=F;--D>=0;){C=E[D],C.setRatios((C.getX()-y)/B,(C.getY()-u)/A,(C.getZ()-w)/depth)}};b.MeshProxy.prototype.resetGeometry=function(){for(var d=this.getVertices(),c=d.length;--c>=0;){d[c].reset()}};b.MeshProxy.prototype.collapseGeometry=function(){for(var d=this.getVertices(),c=d.length;--c>=0;){d[c].collapse()}this.analyzeGeometry()};b.MeshProxy.prototype.getMin=function(a){switch(a){case b.ModConstant.X:return this.minX;case b.ModConstant.Y:return this.minY;case b.ModConstant.Z:return this.minZ}return -1};b.MeshProxy.prototype.getMax=function(a){switch(a){case b.ModConstant.X:return this.maxX;case b.ModConstant.Y:return this.maxY;case b.ModConstant.Z:return this.maxZ}return -1};b.MeshProxy.prototype.getSize=function(a){switch(a){case b.ModConstant.X:return this.width;case b.ModConstant.Y:return this.height;case b.ModConstant.Z:return this.depth}return -1};b.MeshProxy.prototype.setMesh=function(c){this.mesh=c;this.vertices=[];this.faces=[]};b.MeshProxy.prototype.postApply=function(){};b.MeshProxy.prototype.updateMeshPosition=function(){}})(MOD3);(function(b){b.Modifier=function(){this.mod=null};b.Modifier.prototype.setModifiable=function(c){this.mod=c};b.Modifier.prototype.getVertices=function(){return this.mod.getVertices()};b.Modifier.prototype.apply=function(){}})(MOD3);(function(b){b.Library3d=function(){this.id="";this.vertexClass=this.meshClass=null}})(MOD3);(function(b){b.PluginFactory={};b.PluginFactory.getMeshProxy=function(c){return new c.meshClass}})(MOD3);(function(b){b.ModifierStack=function(d,a){this.lib3d=d;this.stack=this.baseMesh=null;this.baseMesh=b.PluginFactory.getMeshProxy(d);this.baseMesh.setMesh(a);this.baseMesh.analyzeGeometry();this.stack=[]};b.ModifierStack.prototype.addModifier=function(c){c.setModifiable(this.baseMesh);this.stack.push(c)};b.ModifierStack.prototype.apply=function(){this.baseMesh.resetGeometry();for(var e=this.stack,c=e.length,f=0;f<c;){e[f++].apply()}this.baseMesh.postApply()};b.ModifierStack.prototype.collapse=function(){this.apply();this.baseMesh.collapseGeometry();this.stack=[]};b.ModifierStack.prototype.clear=function(){this.stack=[]};b.ModifierStack.prototype.getMeshInfo=function(){return this.baseMesh}})(MOD3);(function(b){b.Pivot=function(f,a,e){this.pivot=new b.Vector3(f,a,e)};b.Pivot.prototype=new b.Modifier;b.Pivot.prototype.constructor=b.Pivot;b.Pivot.prototype.setMeshCenter=function(){var a=this.mod;this.pivot=new b.Vector3(-(a.minX+0.5*a.width),-(a.minY+0.5*a.height),-(a.minZ+0.5*a.depth))};b.Pivot.prototype.apply=function(){for(var g=this.mod.getVertices(),c=g.length,j=this.pivot,i,h;--c>=0;){i=g[c],h=i.getVector().clone(),i.setVector(h.add(j))}this.mod.updateMeshPosition(j.clone().negate())}})(MOD3);(function(b){b.Bend=function(f,a,e){this.diagAngle=this.angle=this.offset=this.force=null;this.constraint=b.ModConstant.NONE;this.m2=this.m1=this.origin=this.height=this.width=this.mid=this.min=this.max=null;this.switchAxes=!1;this.force=f;this.offset=a;this.setAngle(e)};b.Bend.prototype=new b.Modifier;b.Bend.prototype.constructor=b.Bend;b.Bend.prototype.setAngle=function(a){this.angle=a;this.m1=new b.Matrix;this.m1.rotate(a);this.m2=new b.Matrix;this.m2.rotate(-a)};b.Bend.prototype.setModifiable=function(a){b.Modifier.prototype.setModifiable.call(this,a);this.max=this.switchAxes?this.mod.midAxis:this.mod.maxAxis;this.min=this.mod.minAxis;this.mid=this.switchAxes?this.mod.maxAxis:this.mod.midAxis;this.width=this.mod.getSize(this.max);this.height=this.mod.getSize(this.mid);this.origin=this.mod.getMin(this.max);this.diagAngle=Math.atan(this.width/this.height)};b.Bend.prototype.apply=function(){if(this.force!=0){for(var O=this.mod.getVertices(),P=O.length,N=this.width,M=this.offset,L=this.origin,K=this.max,J=this.min,I=this.mid,D=this.m1,E=this.m2,C=L+N*M,G=N/Math.PI/this.force,B=b.Constants.doublePI*(N/(G*b.Constants.doublePI)),F,H,A,z,x=1/N,y=b.Constants.halfPI,w=Math.sin,a=Math.cos;--P>=0;){N=O[P],F=N.getValue(K),H=N.getValue(I),A=N.getValue(J),H=D.transformPoint(new b.Point(F,H)),F=H.x,H=H.y,z=(F-L)*x,this.constraint==b.ModConstant.LEFT&&z<=M||this.constraint==b.ModConstant.RIGHT&&z>=M||(z=y-B*M+B*z,F=w(z)*(G+A),z=a(z)*(G+A),A=F-G,F=C-z),H=E.transformPoint(new b.Point(F,H)),F=H.x,H=H.y,N.setValue(K,F),N.setValue(I,H),N.setValue(J,A)}}}})(MOD3);(function(b){b.Bloat=function(){this.center=b.Vector3.ZERO();this.radius=0;this.a=0.01;this.u=b.Vector3.ZERO()};b.Bloat.prototype=new b.Modifier;b.Bloat.prototype.constructor=b.Bloat;b.Bloat.prototype.setRadius=function(c){this.radius=Math.max(0,c)};b.Bloat.prototype.setA=function(c){this.a=Math.max(0,c)};b.Bloat.prototype.apply=function(){for(var i=this.mod.getVertices(),c=i.length,n=this.center,m=this.radius,l=this.a,k,j;--c>=0;){k=i[c],this.u.x=k.getX()-n.x,this.u.y=k.getY()-n.y,this.u.z=k.getZ()-n.z,j=this.u.getMagnitude(),this.u.setMagnitude(j+m*Math.exp(-j*l)),k.setX(this.u.x+n.x),k.setY(this.u.y+n.y),k.setZ(this.u.z+n.z)}}})(MOD3);(function(b){b.Twist=function(a){this.vector=new b.Vector3(0,1,0);this.angle=a;this.center=b.Vector3.ZERO()};b.Twist.prototype=new b.Modifier;b.Twist.prototype.constructor=b.Twist;b.Twist.prototype.apply=function(){this.vector.normalize();for(var n=this.mod,a=n.getVertices(),m=a.length,l=this.vector,k=this.angle,j=this.center,n=1/(new b.Vector3(0.5*n.maxX,0.5*n.maxY,0.5*n.maxZ)).getMagnitude()*k,j=-b.Vector3.dot(l,j),i;--m>=0;){k=a[m],i=k.getX()*l.x+k.getY()*l.y+k.getZ()*l.z+j,this.twistPoint(k,i*n)}};b.Twist.prototype.twistPoint=function(f,a){var e=(new b.Matrix4).translationMatrix(f.getX(),f.getY(),f.getZ()),e=(new b.Matrix4).multiply((new b.Matrix4).rotationMatrix(this.vector.x,this.vector.y,this.vector.z,a),e);f.setX(e.n14);f.setY(e.n24);f.setZ(e.n34)}})(MOD3);(function(b){b.Skew=function(a){this.force=0;this.skewAxis=null;if(typeof a!="undefined"){this.force=a}this.offset=0.5;this.constraint=b.ModConstant.NONE;this.falloff=this.power=1;this.swapAxes=this.oneSide=this.inverseFalloff=!1};b.Skew.prototype=new b.Modifier;b.Skew.prototype.constructor=b.Skew;b.Skew.prototype.setModifiable=function(a){b.Modifier.prototype.setModifiable.call(this,a);this.skewAxis=this.skewAxis||this.mod.maxAxis};b.Skew.prototype.apply=function(){for(var C=this.mod.getVertices(),D=C.length,B=this.constraint,A=this.skewAxis,z=this.offset,y=this.oneSide,x=this.inverseFalloff,w=this.falloff,r=1-w,s=this.power,q=this.force,u=this.getDisplaceAxis(),a,t,v;--D>=0;){a=C[D],!(B==b.ModConstant.LEFT&&a.getRatio(A)<=z)&&!(B==b.ModConstant.RIGHT&&a.getRatio(A)>z)&&(t=a.getRatio(A)-z,y&&(t=Math.abs(t)),v=a.getRatio(u),x&&(v=1-v),v=w+v*r,t=Math.pow(Math.abs(t),s)*b.XMath.sign(t,1),t=a.getValue(u)+q*t*v,a.setValue(u,t))}};b.Skew.prototype.getDisplaceAxis=function(){switch(this.skewAxis){case b.ModConstant.X:return this.swapAxes?b.ModConstant.Z:b.ModConstant.Y;case b.ModConstant.Y:return this.swapAxes?b.ModConstant.Z:b.ModConstant.X;case b.ModConstant.Z:return this.swapAxes?b.ModConstant.Y:b.ModConstant.X;default:return 0}}})(MOD3);(function(b){b.Taper=function(a){this.power=this.force=null;this.start=0;this.end=1;this.vector=new b.Vector3(1,0,1);this.vector2=new b.Vector3(0,1,0);if(typeof a!="undefined"){this.force=a}this.power=1};b.Taper.prototype=new b.Modifier;b.Taper.prototype.constructor=b.Taper;b.Taper.prototype.setFalloff=function(d,c){this.start=0;this.end=1;if(typeof d!="undefined"){this.start=d}if(typeof c!="undefined"){this.end=c}};b.Taper.prototype.apply=function(){for(var q=this.mod.getVertices(),r=q.length,p=this.vector,o=this.vector2,m=this.force,l=this.power,k,j,a;--r>=0;){k=q[r],j=k.getRatioVector().multiply(o),j=m*Math.pow(j.getMagnitude(),l),j=(new b.Matrix4).scaleMatrix(1+j*p.x,1+j*p.y,1+j*p.z),a=k.getVector(),(new b.Matrix4).multiplyVector(j,a),k.setVector(a)}}})(MOD3);(function(b){b.Wheel=function(){this.radius=this.roll=this.turn=this.speed=null;this.steerVector=new b.Vector3(0,1,0);this.rollVector=new b.Vector3(0,0,1);this.roll=this.turn=this.speed=0};b.Wheel.prototype=new b.Modifier;b.Wheel.prototype.constructor=b.Wheel;b.Wheel.prototype.setModifiable=function(a){b.Modifier.prototype.setModifiable.call(this,a);this.radius=0.5*this.mod.width};b.Wheel.prototype.apply=function(){this.roll+=this.speed;var n=this.mod.getVertices(),a=n.length,m=this.steerVector,l=this.turn,k=this.rollVector,j=this.roll,i;0!=l?(i=(new b.Matrix4).rotationMatrix(m.x,m.y,m.z,l),m=k.clone(),(new b.Matrix4).multiplyVector(i,m),j=(new b.Matrix4).rotationMatrix(m.x,m.y,m.z,j)):j=(new b.Matrix4).rotationMatrix(k.x,k.y,k.z,j);for(;--a>=0;){m=n[a],k=m.getVector().clone(),0!=l&&(new b.Matrix4).multiplyVector(i,k),(new b.Matrix4).multiplyVector(j,k),m.setX(k.x),m.setY(k.y),m.setZ(k.z)}};b.Wheel.prototype.getStep=function(){return this.radius*this.speed*b.Constants.invPI};b.Wheel.prototype.getPerimeter=function(){return this.radius*b.Constants.doublePI}})(MOD3);(function(b){b.Break=function(d,a){this.bv=new b.Vector3(0,1,0);this.angle=this.offset=0;if(typeof d!="undefined"){this.offset=d}if(typeof a!="undefined"){this.angle=a}this.range=new b.Range(0,1)};b.Break.prototype=new b.Modifier;b.Break.prototype.constructor=b.Break;b.Break.prototype.apply=function(){var p=this.mod,a=p.getVertices(),o=a.length,n=this.range,m=this.angle,l=this.bv,k,j,p=new b.Vector3(0,0,-(p.minZ+p.depth*this.offset));k=p.negate();for(j=(new b.Matrix4).rotationMatrix(l.x,l.y,l.z,m);--o>=0;){m=a[o],l=m.getVector(),l=l.add(p),l.z>=0&&n.isIn(m.ratioY)&&(new b.Matrix4).multiplyVector(j,l),l=l.add(k),m.setX(l.x),m.setY(l.y),m.setZ(l.z)}}})(MOD3);(function(b){b.Noise=function(a){this.force=0;this.axc=b.ModConstant.NONE;this.end=this.start=0;if(typeof a!="undefined"){this.force=a}};b.Noise.prototype=new b.Modifier;b.Noise.prototype.constructor=b.Noise;b.Noise.prototype.constraintAxes=function(c){this.axc=c};b.Noise.prototype.setFalloff=function(d,c){this.start=0;this.end=1;if(typeof d!="undefined"){this.start=d}if(typeof c!="undefined"){this.end=c}};b.Noise.prototype.apply=function(){for(var x=this.mod,w=this.axc,v=this.start,u=this.end,t=x.getVertices(),s=t.length,r=this.force,q=0.5*r,j=Math.random,l,c,p;--s>=0;){l=t[s],c=j()*r-q,p=l.getRatio(x.maxAxis),v<u?(p<v&&(p=0),p>u&&(p=1)):v>u?(p=1-p,p>v&&(p=0),p<u&&(p=1)):p=1,w&1||l.setX(l.getX()+c*p),w>>1&1||l.setY(l.getY()+c*p),w>>2&1||l.setZ(l.getZ()+c*p)}}})(MOD3);(function(b){b.LibraryThree=function(){this.id="Three.js";this.meshClass=b.MeshThree;this.vertexClass=b.VertexThree};b.LibraryThree.prototype=new b.Library3d;b.LibraryThree.prototype.constructor=b.LibraryThree})(MOD3);(function(b){b.VertexThree=function(c){this.mesh=c};b.VertexThree.prototype=new b.VertexProxy;b.VertexThree.prototype.setVertex=function(c){this.vertex=c;this.originalX=c.x;this.originalY=c.y;this.originalZ=c.z};b.VertexThree.prototype.getX=function(){return this.vertex.x};b.VertexThree.prototype.getY=function(){return this.vertex.y};b.VertexThree.prototype.getZ=function(){return this.vertex.z};b.VertexThree.prototype.setX=function(c){this.vertex.x=c;c=this.mesh;c.geometry.verticesNeedUpdate=!0;c.geometry.normalsNeedUpdate=!0;c.geometry.buffersNeedUpdate=!0;c.geometry.dynamic=!0};b.VertexThree.prototype.setY=function(c){this.vertex.y=c;c=this.mesh;c.geometry.verticesNeedUpdate=!0;c.geometry.normalsNeedUpdate=!0;c.geometry.buffersNeedUpdate=!0;c.geometry.dynamic=!0};b.VertexThree.prototype.setZ=function(c){this.vertex.z=c;c=this.mesh;c.geometry.verticesNeedUpdate=!0;c.geometry.normalsNeedUpdate=!0;c.geometry.buffersNeedUpdate=!0;c.geometry.dynamic=!0}})(MOD3);(function(b){b.MeshThree=function(){};b.MeshThree.prototype=new b.MeshProxy;b.MeshThree.prototype.setMesh=function(n){b.MeshProxy.prototype.setMesh.call(this,n);for(var n=[],a=0,m=this.mesh.geometry.vertices,l=m.length,k=this.mesh.geometry.faces,j=k.length,i,a=0;a<l;){i=new b.VertexThree(this.mesh),i.setVertex(m[a]),this.vertices.push(i),n[m[a]]=i,a++}for(a=0;a<j;){l=new b.FaceProxy,k[a] instanceof THREE.Face3?(l.addVertex(n[m[k[a].a]]),l.addVertex(n[m[k[a].b]]),l.addVertex(n[m[k[a].c]])):k[a] instanceof THREE.Face4&&(l.addVertex(n[m[k[a].a]]),l.addVertex(n[m[k[a].b]]),l.addVertex(n[m[k[a].c]]),l.addVertex(n[m[k[a].d]])),this.faces.push(l),a++}delete lookup};b.MeshThree.prototype.updateMeshPosition=function(d){var c=this.mesh;c.position.x+=d.x;c.position.y+=d.y;c.position.z+=d.z}})(MOD3);(function(b){b.LibraryPre3D=function(){this.id="pre3d.js";this.meshClass=b.MeshPre3D;this.vertexClass=b.VertexPre3D};b.LibraryThree.prototype=new b.Library3d;b.LibraryThree.prototype.constructor=b.LibraryPre3D})(MOD3);(function(b){b.VertexPre3D=function(){};b.VertexPre3D.prototype=new b.VertexProxy;b.VertexPre3D.prototype.setVertex=function(c){this.vertex=c;this.originalX=c.x;this.originalY=c.y;this.originalZ=c.z};b.VertexPre3D.prototype.getX=function(){return this.vertex.x};b.VertexPre3D.prototype.getY=function(){return this.vertex.y};b.VertexPre3D.prototype.getZ=function(){return this.vertex.z};b.VertexPre3D.prototype.setX=function(c){this.vertex.x=c};b.VertexPre3D.prototype.setY=function(c){this.vertex.y=c};b.VertexPre3D.prototype.setZ=function(c){this.vertex.z=c}})(MOD3);(function(b){b.MeshPre3D=function(){};b.MeshPre3D.prototype=new b.MeshProxy;b.MeshPre3D.prototype.setMesh=function(n){b.MeshProxy.prototype.setMesh.call(this,n);for(var n=[],a=this.mesh.vertices,m=this.mesh.quads,l=a.length,k=m.length,j=0;j<l;j++){var i=new b.VertexPre3D;i.setVertex(a[j]);this.vertices.push(i);n[a[j]]=i}for(j=0;j<k;j++){l=new b.FaceProxy,m[j] instanceof Pre3d.QuadFace&&(l.addVertex(n[a[m[j].i0]]),l.addVertex(n[a[m[j].i1]]),l.addVertex(n[a[m[j].i2]]),m[j].i3!=null&&l.addVertex(n[a[m[j].i3]])),this.faces.push(l)}delete lookup};b.MeshPre3D.prototype.updateMeshPosition=function(){}})(MOD3);(function(b){b.LibraryJ3D=function(){this.id="J3D";this.meshClass=b.MeshJ3D;this.vertexClass=b.VertexJ3D};b.LibraryJ3D.prototype=new b.Library3d;b.LibraryJ3D.prototype.constructor=b.LibraryJ3D})(MOD3);(function(b){b.VertexJ3D=function(c){this.geometry=c};b.VertexJ3D.prototype=new b.VertexProxy;b.VertexJ3D.prototype.setVertex=function(d){this.vertex=d;var c=this.geometry;this.originalX=c.vertexPositionBuffer.data[d];this.originalY=c.vertexPositionBuffer.data[d+1];this.originalZ=c.vertexPositionBuffer.data[d+2]};b.VertexJ3D.prototype.getX=function(){return this.geometry.vertexPositionBuffer.data[this.vertex]};b.VertexJ3D.prototype.getY=function(){return this.geometry.vertexPositionBuffer.data[this.vertex+1]};b.VertexJ3D.prototype.getZ=function(){return this.geometry.vertexPositionBuffer.data[this.vertex+2]};b.VertexJ3D.prototype.setX=function(d){var c=this.geometry;c.vertexPositionBuffer.data[this.vertex]=d;c.replaceArray(c.vertexPositionBuffer,c.vertexPositionBuffer.data)};b.VertexJ3D.prototype.setY=function(d){var c=this.geometry;c.vertexPositionBuffer.data[this.vertex+1]=d;c.replaceArray(c.vertexPositionBuffer,c.vertexPositionBuffer.data)};b.VertexJ3D.prototype.setZ=function(d){var c=this.geometry;c.vertexPositionBuffer.data[this.vertex+2]=d;c.replaceArray(c.vertexPositionBuffer,c.vertexPositionBuffer.data)}})(MOD3);(function(b){b.MeshJ3D=function(){};b.MeshJ3D.prototype=new b.MeshProxy;b.MeshJ3D.prototype.setMesh=function(j){b.MeshProxy.prototype.setMesh.call(this,j);for(var a=0,i=j.geometry.vertexPositionBuffer.data.length,h=j.geometry.vertexPositionBuffer.itemSize,g,a=0;a<i;){g=new b.VertexJ3D(j.geometry),g.setVertex(a),this.vertices.push(g),a+=h}this.faces=null};b.MeshJ3D.prototype.updateMeshPosition=function(d){var c=this.mesh;c.position.x+=d.x;c.position.y+=d.y;c.position.z+=d.z}})(MOD3);(function(b){b.LibraryCopperlicht=function(){this.id="Copperlicht";this.meshClass=b.MeshCopperlicht;this.vertexClass=b.VertexCopperlicht};b.LibraryCopperlicht.prototype=new b.Library3d;b.LibraryCopperlicht.prototype.constructor=b.LibraryCopperlicht})(MOD3);(function(b){b.VertexCopperlicht=function(d,c){this.node=d;this.buffer=c};b.VertexCopperlicht.prototype=new b.VertexProxy;b.VertexCopperlicht.prototype.setVertex=function(c){this.vertex=c;this.originalX=this.vertex.Pos.X;this.originalY=this.vertex.Pos.Y;this.originalZ=this.vertex.Pos.Z};b.VertexCopperlicht.prototype.getX=function(){return this.vertex.Pos.X};b.VertexCopperlicht.prototype.getY=function(){return this.vertex.Pos.Y};b.VertexCopperlicht.prototype.getZ=function(){return this.vertex.Pos.Z};b.VertexCopperlicht.prototype.setX=function(c){this.vertex.Pos.X=c;this.buffer.update(!0)};b.VertexCopperlicht.prototype.setY=function(c){this.vertex.Pos.Y=c;this.buffer.update(!0)};b.VertexCopperlicht.prototype.setZ=function(c){this.vertex.Pos.Z=c;this.buffer.update(!0)}})(MOD3);(function(b){b.MeshCopperlicht=function(){};b.MeshCopperlicht.prototype=new b.MeshProxy;b.MeshCopperlicht.prototype.setMesh=function(l){b.MeshProxy.prototype.setMesh.call(this,l);for(var l=this.mesh.getMesh().GetMeshBuffers(),a=[],k=0;k<l.length;k++){for(var a=l[k].Vertices,j=a.length,i=0;i<j;i++){var h=new b.VertexCopperlicht(this.mesh,l[k]);h.setVertex(a[i]);this.vertices.push(h)}}this.faces=null;delete lookup};b.MeshCopperlicht.prototype.updateMeshPosition=function(c){this.mesh.Pos.X+=c.x;this.mesh.Pos.Y+=c.y;this.mesh.Pos.Z+=c.z}})(MOD3);FLIPBOOK.Page=function(j,a,g,e,b){this.wrapper=document.createElement("div");jQuery(this.wrapper).addClass("flipbook-page");this.s=this.wrapper.style;this.s.width=String(a)+"px";this.s.height=String(g)+"px";this.index=e;this.book=b;this.width=a;this.height=g;this.invisible=false;this.image=new Image();this.image.src=b.options.assets.preloader;this.imageSrc=j.src;this.wrapper.appendChild(this.image);this.imageLoader=new Image();this.overlay=new Image();this.overlay.src=b.options.assets.overlay;this.wrapper.appendChild(this.overlay);this.overlay.style.opacity="0";this.expanded=true;this.htmlContent=j.htmlContent;if(this.index%2==0){this.s.zIndex=String(100-this.index);this.s.left="50%";this.right(this.image);this.right(this.overlay)}else{this.shadow=new Image();this.wrapper.appendChild(this.shadow);this.shadow.src=b.options.assets.left;this.left(this.shadow);this.s.zIndex=String(100+this.index);this.s.right="50%";this.left(this.image);this.left(this.overlay)}if(typeof this.htmlContent!=="undefined"){this.htmlContainer=document.createElement("div");jQuery(this.htmlContainer).addClass("flipbook-page-htmlContainer");this.wrapper.appendChild(this.htmlContainer);this.index%2==0?this.right(this.htmlContainer):this.left(this.htmlContainer)}this.image.style[this.book.transform]="translateZ(0)";this.overlay.style[this.book.transform]="translateZ(0)";this.overlay.style["pointer-events"]="none";if(this.shadow){this.shadow.style[this.book.transform]="translateZ(0)";this.shadow.style["pointer-events"]="none"}this.s.top="0px";if(this.book.flipType=="3d"){this.wrapper.style[this.book.transformOrigin]=(this.index%2!=0)?"100% 50%":"0% 50%"}if(j.links){var h=this;for(var d=0;d<j.links.length;d++){var f=j.links[d];function c(k){var i=document.createElement("div");h.wrapper.appendChild(i);i.classList.add("flipbook-page-link");i.style.position="absolute";i.style.left=String(k.x)+"px";i.style.top=String(k.y)+"px";i.style.width=String(k.width)+"px";i.style.height=String(k.height)+"px";i.style.backgroundColor=k.color;i.style.opacity=k.alpha;i.style.cursor="pointer";jQuery(i).click(function(l){if(Number(k.page)>0){b.goToPage(Number(k.page))}else{if(String(k.url)!=""){window.open(k.url)}}}).mouseenter(function(){i.style.backgroundColor=k.hoverColor;i.style.opacity=k.hoverAlpha}).mouseleave(function(){i.style.backgroundColor=k.color;i.style.opacity=k.alpha})}c(f)}}};FLIPBOOK.Page.prototype={loadPage:function(){if(this.loaded==true){return}this.loaded=true;var a=this;a.imageLoader.src=this.imageSrc;jQuery(a.imageLoader).load(function(){a.image.src=a.imageSrc});if(typeof this.htmlContent!=="undefined"){this.htmlContainer.innerHTML=this.htmlContent}},flipView:function(){},expand:function(){if(!this.expanded){this.s.width=String(this.width)+"px"}this.expanded=true},contract:function(){if(this.expanded){this.s.width="0px"}this.expanded=false},show:function(){if(this.hidden){this.s.display="block"}this.hidden=false},hide:function(){if(!this.hidden){this.s.display="none"}this.hidden=true},hideVisibility:function(){if(!this.invisible){this.s.visibility="hidden"}this.invisible=true},left:function(b){var a=b.style;a.width=String(this.width)+"px";a.height=String(this.height)+"px";a.position="absolute";a.top="0px";a.right="0px"},right:function(b){var a=b.style;a.width=String(this.width)+"px";a.height=String(this.height)+"px";a.position="absolute";a.top="0px";a.left="0px"}};var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.PageWebGL=function(f,g,l,d,m,n){this.book=f;this.matFront=l;this.matBack=d;this.index=g;this.pageMaterial=n.pageMaterial;this.pW=n.pageWidth;this.pH=n.pageHeight;this.pageShininess=n.pageShininess;this.nfacesw=n.pageSegmentsW;this.nfacesh=n.pageSegmentsH;this.mats=[];this.pageHardness=m;this.pageThickness=m;this.duration=n.pageFlipDuration;this.angle=0.25*Math.PI*this.pW/this.pH;this.force=10;this.offset=0;this.to=null;this.flipPt=0.3;this.mod=null;this.bend=null;this.pivot=null;this.isFlippedLeft=false;this.isFlippedRight=true;this.flippingLeft=false;this.flippingRight=false;this.zz=2;this.sides={bottom:3,top:2,right:0,left:1,front:4,back:5};var e;for(var h=0;h<6;h++){if(h==this.sides.front){this.mats[this.sides.front]=this.createMaterial(this.pageMaterial,this.matFront)}else{if(h==this.sides.back){this.mats[this.sides.back]=this.createMaterial(this.pageMaterial,this.matBack)}else{var b=parseInt(Math.random()*7);var k=[3355443,5592405,7829367,10066329,11184810,14540253,16777215];var j=k[b];this.mats[h]=new THREE.MeshBasicMaterial({color:j})}}}THREE.Mesh.call(this,new THREE.CubeGeometry(this.pW,this.pH,this.pageThickness,this.nfacesw,this.nfacesh,1),new THREE.MeshFaceMaterial(this.mats));this.overdraw=true;this.position.x=this.pW*0.5;if(this.index>0){this.position.z=this.book.pages[this.index-1].position.z-this.book.pages[this.index-1].pageThickness/2-this.pageThickness/2-1}else{this.position.z=this.pageThickness/2}this.mod=new MOD3.ModifierStack(new MOD3.LibraryThree(),this);this.pivot=new MOD3.Pivot(this.position.x,0,0);this.mod.addModifier(this.pivot);this.mod.collapse();this.bend=new MOD3.Bend(0,0,0);this.bend.constraint=MOD3.ModConstant.LEFT;if(this.pH>this.pW){this.bend.switchAxes=true}this.mod.addModifier(this.bend)};FLIPBOOK.PageWebGL.prototype=new THREE.Mesh();FLIPBOOK.PageWebGL.prototype.constructor=FLIPBOOK.PageWebGL;FLIPBOOK.PageWebGL.prototype.createMaterial=function(b,c){var a;if(b=="lambert"){a=new THREE.MeshLambertMaterial({map:c,overdraw:true,ambient:16777215,specular:16777215,diffuse:16777215,shininess:40,perPixel:true})}else{if(b=="phong"){a=new THREE.MeshPhongMaterial({map:c,overdraw:true,ambient:16777215,specular:16777215,diffuse:16777215,shininess:40,perPixel:true})}else{if(b=="basic"){a=new THREE.MeshBasicMaterial({map:c,overdraw:true,perPixel:true})}}}return a};FLIPBOOK.PageWebGL.prototype.flipLeft=function(c){if(!this.isFlippedLeft&&!this.flippingLeft&&!this.flippingRight&&this.index==this.book.flippedleft){this.flippingLeft=true;this.flipping=true;this.force=0;var b=(1+Math.random())/(this.pageHardness);var d=0.1+Math.random()*0.2;this.to={angle:this.rotation.y,t:-1,xx:0,thiss:this,force:this.force,offset:this.offset};this.bendIn(-Math.PI,b,d);this.position.z=this.pageThickness/2+1;for(var a=this.index-1;a>=0;a--){this.book.pages[a].position.z=this.book.pages[a+1].position.z-this.book.pages[a+1].pageThickness/2-this.book.pages[a].pageThickness/2-1}for(var a=this.index+1;a<this.book.pages.length;a++){this.book.pages[a].position.z=this.book.pages[a-1].position.z-this.book.pages[a-1].pageThickness/2-this.book.pages[a].pageThickness/2-1}}};FLIPBOOK.PageWebGL.prototype.flipRight=function(c){if(!this.isFlippedRight&&!this.flippingRight&&!this.flippingLeft&&this.index==this.book.getNumPages()-this.book.flippedright-1){this.flippingRight=true;this.flipping=true;this.force=0;this.to={angle:this.rotation.y,t:-1,xx:0,thiss:this,force:this.force,offset:this.offset};var b=(-1-Math.random()*0.5)/this.pageHardness;var d=0.1+Math.random()*0.2;this.bendIn(0,b,d);this.position.z=this.pageThickness/2+1;for(var a=this.index+1;a<this.book.pages.length;a++){this.book.pages[a].position.z=this.book.pages[a-1].position.z-this.book.pages[a-1].pageThickness/2-this.book.pages[a].pageThickness/2-1}for(var a=this.index-1;a>=0;a--){this.book.pages[a].position.z=this.book.pages[a+1].position.z-this.book.pages[a+1].pageThickness/2-this.book.pages[a].pageThickness/2-1}}};FLIPBOOK.PageWebGL.prototype.bendIn=function(d,b,e){this.bend.setAngle(Math.random()*(Math.PI/6)-(Math.PI/12));this.bend.force=0;this.bend.offset=0;this.mod.apply();var c=this.duration*(400+this.pageHardness*5);var a=this.duration*(225+this.pageHardness*5);new TWEEN.Tween(this.to).to({angle:d,xx:1,t:1},c).easing(TWEEN.Easing.Sinusoidal.EaseInOut).onUpdate(this.renderFlip).start();new TWEEN.Tween(this.to).to({force:b},a).easing(TWEEN.Easing.Quadratic.EaseIn).onUpdate(this.modApply).onComplete(this.bendOut).start();new TWEEN.Tween(this.to).to({offset:e},a).easing(TWEEN.Easing.Quadratic.EaseOut).onUpdate(this.modApply).start()};FLIPBOOK.PageWebGL.prototype.bendOut=function(){var a=this.thiss.duration*(700-this.thiss.pageHardness*75);new TWEEN.Tween(this.thiss.to).to({force:0},a).easing(TWEEN.Easing.Sinusoidal.EaseIn).onUpdate(this.thiss.modApply).start();new TWEEN.Tween(this.thiss.to).to({force:0,offset:1},a).easing(TWEEN.Easing.Sinusoidal.EaseInOut).onUpdate(this.thiss.modApply).onComplete(this.thiss.flipFinished).start()};FLIPBOOK.PageWebGL.prototype.modApply=function(){this.thiss.bend.force=this.force;this.thiss.bend.offset=this.offset;this.thiss.mod.apply();this.thiss.geometry.computeCentroids();this.thiss.geometry.computeFaceNormals();var b=this.thiss.geometry;a(this.thiss.nfacesw,this.thiss.nfacesh,1,b);function a(p,i,n,j){var q,e,k,o,m,l;if(this.__tmpVertices===undefined){this.__tmpVertices=new Array(j.vertices.length);l=this.__tmpVertices;for(q=0,e=j.vertices.length;q<e;q++){l[q]=new THREE.Vector3()}for(k=0,o=j.faces.length;k<o;k++){m=j.faces[k];m.vertexNormals=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()]}}else{l=this.__tmpVertices;for(q=0,e=j.vertices.length;q<e;q++){l[q].set(0,0,0)}}var c=2*p*n+2*i*n;for(k=c,o=j.faces.length;k<o;k++){m=j.faces[k];if(m instanceof THREE.Face3){l[m.a].add(m.normal);l[m.b].add(m.normal);l[m.c].add(m.normal)}else{if(m instanceof THREE.Face4){l[m.a].add(m.normal);l[m.b].add(m.normal);l[m.c].add(m.normal);l[m.d].add(m.normal)}}}for(q=0,e=j.vertices.length;q<e;q++){l[q].normalize()}for(k=0,o=j.faces.length;k<o;k++){m=j.faces[k];if(m instanceof THREE.Face3){m.vertexNormals[0].copy(l[m.a]);m.vertexNormals[1].copy(l[m.b]);m.vertexNormals[2].copy(l[m.c])}else{if(m instanceof THREE.Face4){m.vertexNormals[0].copy(l[m.a]);m.vertexNormals[1].copy(l[m.b]);m.vertexNormals[2].copy(l[m.c]);m.vertexNormals[3].copy(l[m.d])}}}}};FLIPBOOK.PageWebGL.prototype.renderFlip=function(){var a=Math.PI*0.5;if(this.thiss.flippingLeft&&this.thiss.index==0&&this.thiss.book.getNumPages()>1){this.thiss.book.centerContainer.position.x=(1-this.xx)*this.thiss.book.centerContainer.position.x}else{if(this.thiss.flippingLeft&&this.thiss.index==this.thiss.book.getNumPages()-1){this.thiss.book.centerContainer.position.x=(1-this.xx)*this.thiss.book.centerContainer.position.x+this.xx*this.thiss.book.pageW*0.5}else{if(this.thiss.flippingRight&&this.thiss.index==0){this.thiss.book.centerContainer.position.x=(1-this.xx)*this.thiss.book.centerContainer.position.x-this.xx*this.thiss.book.pageW*0.5}else{if(this.thiss.flippingRight&&this.thiss.index==this.thiss.book.getNumPages()-1){this.thiss.book.centerContainer.position.x=(1-this.xx)*this.thiss.book.centerContainer.position.x}}}}this.thiss.rotation.y=this.angle};FLIPBOOK.PageWebGL.prototype.flipFinished=function(){if(this.thiss.flippingLeft){this.thiss.flippingLeft=false;this.thiss.isFlippedLeft=true;this.thiss.flippingRight=false;this.thiss.isFlippedRight=false}else{if(this.thiss.flippingRight){this.thiss.flippingLeft=false;this.thiss.isFlippedRight=true;this.thiss.flippingRight=false;this.thiss.isFlippedLeft=false}}this.thiss.bend.force=0;this.thiss.bend.offset=0;this.thiss.mod.apply();this.thiss.flipping=false};FLIPBOOK.PageWebGL.prototype.isFlippedLeft=function(){return this.thiss.isFlippedLeft};FLIPBOOK.PageWebGL.prototype.isFlippedRight=function(){return this.thiss.isFlippedRight};var THREEx=THREEx||{};THREEx.FullScreen=THREEx.FullScreen||{};THREEx.FullScreen.available=function(){return this._hasWebkitFullScreen||this._hasMozFullScreen};THREEx.FullScreen.activated=function(){if(this._hasWebkitFullScreen){return document.webkitIsFullScreen}else{if(this._hasMozFullScreen){return document.mozFullScreen}else{console.assert(false)}}};THREEx.FullScreen.request=function(a){a=a||document.body;if(this._hasWebkitFullScreen){a.webkitRequestFullScreen()}else{if(this._hasMozFullScreen){a.mozRequestFullScreen()}else{console.assert(false)}}};THREEx.FullScreen.cancel=function(){if(this._hasWebkitFullScreen){document.webkitCancelFullScreen()}else{if(this._hasMozFullScreen){document.mozCancelFullScreen()}else{console.assert(false)}}};THREEx.FullScreen._hasWebkitFullScreen="webkitCancelFullScreen" in document?true:false;THREEx.FullScreen._hasMozFullScreen="mozCancelFullScreen" in document?true:false;FLIPBOOK.Thumb=function(e,c,f,d,a,b){this.image=new Image();this.image.src=c.options.assets.preloader;this.image.style.width=String(d)+"px";this.image.style.height=String(a)+"px";this.imageSrc=f;this.index=b;this.image.style.position="absolute";this.image.style.userSelect="none";this.image.style.margin="0px";this.image.style.padding="0px";this.image.style.webkitUserSelect="none";this.image.style.MozUserSelect="none";this.image.setAttribute("unselectable","on");this.width=d;this.height=a;this.$=e;this.preloader=new Image()};FLIPBOOK.Thumb.prototype={loadImage:function(){var a=this;this.preloader.src=this.imageSrc;this.$(this.preloader).load(function(){a.image.src=a.imageSrc})}};var TWEEN=TWEEN||function(){var f,i,j=60,d=false,g=[];return{setFPS:function(a){j=a||60},start:function(a){arguments.length!=0&&this.setFPS(a);i=setInterval(this.update,1000/j)},stop:function(){clearInterval(i)},setAutostart:function(a){(d=a)&&!i&&this.start()},add:function(a){g.push(a);d&&!i&&this.start()},getAll:function(){return g},removeAll:function(){g=[]},remove:function(a){f=g.indexOf(a);f!==-1&&g.splice(f,1)},update:function(a){f=0;num_tweens=g.length;for(a=a||Date.now();f<num_tweens;){if(g[f].update(a)){f++}else{g.splice(f,1);num_tweens--}}num_tweens==0&&d==true&&this.stop()}}}();TWEEN.Tween=function(v){var s={},t={},u={},q=1000,r=0,p=null,d=TWEEN.Easing.Linear.EaseNone,o=null,i=null,g=null;this.to=function(c,b){if(b!==null){q=b}for(var a in c){if(v[a]!==null){u[a]=c[a]}}return this};this.start=function(b){TWEEN.add(this);p=b?b+r:Date.now()+r;for(var a in u){if(v[a]!==null){s[a]=v[a];t[a]=u[a]-v[a]}}return this};this.stop=function(){TWEEN.remove(this);return this};this.delay=function(a){r=a;return this};this.easing=function(a){d=a;return this};this.chain=function(a){o=a};this.onUpdate=function(a){i=a;return this};this.onComplete=function(a){g=a;return this};this.update=function(c){var b,a;if(c<p){return true}c=(c-p)/q;c=c>1?1:c;a=d(c);for(b in t){v[b]=s[b]+t[b]*a}i!==null&&i.call(v,a);if(c==1){g!==null&&g.call(v);o!==null&&o.start();return false}return true}};TWEEN.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};TWEEN.Easing.Linear.EaseNone=function(b){return b};TWEEN.Easing.Quadratic.EaseIn=function(b){return b*b};TWEEN.Easing.Quadratic.EaseOut=function(b){return -b*(b-2)};TWEEN.Easing.Quadratic.EaseInOut=function(b){if((b*=2)<1){return 0.5*b*b}return -0.5*(--b*(b-2)-1)};TWEEN.Easing.Cubic.EaseIn=function(b){return b*b*b};TWEEN.Easing.Cubic.EaseOut=function(b){return --b*b*b+1};TWEEN.Easing.Cubic.EaseInOut=function(b){if((b*=2)<1){return 0.5*b*b*b}return 0.5*((b-=2)*b*b+2)};TWEEN.Easing.Quartic.EaseIn=function(b){return b*b*b*b};TWEEN.Easing.Quartic.EaseOut=function(b){return -(--b*b*b*b-1)};TWEEN.Easing.Quartic.EaseInOut=function(b){if((b*=2)<1){return 0.5*b*b*b*b}return -0.5*((b-=2)*b*b*b-2)};TWEEN.Easing.Quintic.EaseIn=function(b){return b*b*b*b*b};TWEEN.Easing.Quintic.EaseOut=function(b){return(b-=1)*b*b*b*b+1};TWEEN.Easing.Quintic.EaseInOut=function(b){if((b*=2)<1){return 0.5*b*b*b*b*b}return 0.5*((b-=2)*b*b*b*b+2)};TWEEN.Easing.Sinusoidal.EaseIn=function(b){return -Math.cos(b*Math.PI/2)+1};TWEEN.Easing.Sinusoidal.EaseOut=function(b){return Math.sin(b*Math.PI/2)};TWEEN.Easing.Sinusoidal.EaseInOut=function(b){return -0.5*(Math.cos(Math.PI*b)-1)};TWEEN.Easing.Exponential.EaseIn=function(b){return b==0?0:Math.pow(2,10*(b-1))};TWEEN.Easing.Exponential.EaseOut=function(b){return b==1?1:-Math.pow(2,-10*b)+1};TWEEN.Easing.Exponential.EaseInOut=function(b){if(b==0){return 0}if(b==1){return 1}if((b*=2)<1){return 0.5*Math.pow(2,10*(b-1))}return 0.5*(-Math.pow(2,-10*(b-1))+2)};TWEEN.Easing.Circular.EaseIn=function(b){return -(Math.sqrt(1-b*b)-1)};TWEEN.Easing.Circular.EaseOut=function(b){return Math.sqrt(1- --b*b)};TWEEN.Easing.Circular.EaseInOut=function(b){if((b/=0.5)<1){return -0.5*(Math.sqrt(1-b*b)-1)}return 0.5*(Math.sqrt(1-(b-=2)*b)+1)};TWEEN.Easing.Elastic.EaseIn=function(f){var g,h=0.1,d=0.4;if(f==0){return 0}if(f==1){return 1}d||(d=0.3);if(!h||h<1){h=1;g=d/4}else{g=d/(2*Math.PI)*Math.asin(1/h)}return -(h*Math.pow(2,10*(f-=1))*Math.sin((f-g)*2*Math.PI/d))};TWEEN.Easing.Elastic.EaseOut=function(f){var g,h=0.1,d=0.4;if(f==0){return 0}if(f==1){return 1}d||(d=0.3);if(!h||h<1){h=1;g=d/4}else{g=d/(2*Math.PI)*Math.asin(1/h)}return h*Math.pow(2,-10*f)*Math.sin((f-g)*2*Math.PI/d)+1};TWEEN.Easing.Elastic.EaseInOut=function(f){var g,h=0.1,d=0.4;if(f==0){return 0}if(f==1){return 1}d||(d=0.3);if(!h||h<1){h=1;g=d/4}else{g=d/(2*Math.PI)*Math.asin(1/h)}if((f*=2)<1){return -0.5*h*Math.pow(2,10*(f-=1))*Math.sin((f-g)*2*Math.PI/d)}return h*Math.pow(2,-10*(f-=1))*Math.sin((f-g)*2*Math.PI/d)*0.5+1};TWEEN.Easing.Back.EaseIn=function(b){return b*b*(2.70158*b-1.70158)};TWEEN.Easing.Back.EaseOut=function(b){return(b-=1)*b*(2.70158*b+1.70158)+1};TWEEN.Easing.Back.EaseInOut=function(b){if((b*=2)<1){return 0.5*b*b*(3.5949095*b-2.5949095)}return 0.5*((b-=2)*b*(3.5949095*b+2.5949095)+2)};TWEEN.Easing.Bounce.EaseIn=function(b){return 1-TWEEN.Easing.Bounce.EaseOut(1-b)};TWEEN.Easing.Bounce.EaseOut=function(b){return(b/=1)<1/2.75?7.5625*b*b:b<2/2.75?7.5625*(b-=1.5/2.75)*b+0.75:b<2.5/2.75?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375};TWEEN.Easing.Bounce.EaseInOut=function(b){if(b<0.5){return TWEEN.Easing.Bounce.EaseIn(b*2)*0.5}return TWEEN.Easing.Bounce.EaseOut(b*2-1)*0.5+0.5};